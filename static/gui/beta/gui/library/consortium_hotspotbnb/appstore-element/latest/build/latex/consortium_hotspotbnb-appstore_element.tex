%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,openany,oneside,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsable pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage[english]{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}


\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{Element WebApp}
\date{Aug 09, 2021}
\release{0.0.0}
\author{Author(s): DATRO Consortium}
\newcommand{\sphinxlogo}{\sphinxincludegraphics{logo.png}\par}
\renewcommand{\releasename}{Communications Protocol | Version}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}



\chapter{Release Notes and Notices}
\label{\detokenize{releasenotes:release-notes-and-notices}}\label{\detokenize{releasenotes::doc}}
\sphinxAtStartPar
This section provides information about what is new or changed, including urgent issues, documentation updates, maintenance, and new releases.
\begin{itemize}
\item {} 
\sphinxAtStartPar
‚ÄòUpdates‚Äô are the term used to describe significant changes to our public source code and/or records.

\end{itemize}


\section{This Release (Version 0.0.0)}
\label{\detokenize{releasenotes:this-release-version-0-0-0}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{2021\sphinxhyphen{}Jul\sphinxhyphen{}31} \sphinxhyphen{} \sphinxtitleref{Client rescheduled conference call and registred more users on matrix.\$url}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{2021\sphinxhyphen{}Jul\sphinxhyphen{}30} \sphinxhyphen{} \sphinxtitleref{Integrated video/voice conferencing added e.g. jitsi.\$url1 \& element.\$url1}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{2021\sphinxhyphen{}Jul\sphinxhyphen{}29} \sphinxhyphen{} \sphinxtitleref{Server moved to be closer to core/backbone of infrastructure}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{2021\sphinxhyphen{}Jul\sphinxhyphen{}28} \sphinxhyphen{} \sphinxtitleref{Conference call scheduled to discuss \sphinxhyphen{} client had to cancel last minute}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{2021\sphinxhyphen{}Jul\sphinxhyphen{}26} \sphinxhyphen{} \sphinxtitleref{Re\sphinxhyphen{}send clarification of registration process to client}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{2021\sphinxhyphen{}Jul\sphinxhyphen{}24} \sphinxhyphen{} \sphinxtitleref{Client send url (matrix.\$url1) to register users using public gui e.g. element.io (messaging/fileshare only)}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{2021\sphinxhyphen{}Jul\sphinxhyphen{}22} \sphinxhyphen{} {\color{red}\bfseries{}\textasciigrave{}}Two solutions in development \sphinxhyphen{} \$url1 (standard/fallback) \& \$url2 (high\sphinxhyphen{}security/main)‚Äô

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{2021\sphinxhyphen{}Jul\sphinxhyphen{}20} \sphinxhyphen{} \sphinxtitleref{Client commited to ‚Äúsecure comms \sphinxhyphen{} matrix server setup‚Äù}

\end{itemize}


\section{Older Versions}
\label{\detokenize{releasenotes:older-versions}}\begin{quote}

\sphinxAtStartPar
In the table below the last entry displays a link to an archived copy of the last report.
To keep the filename from overflowing in the table below the name displayed may differ from the file name.
The date the file was archived will differ from the date of the document label, which is its creation date.
If you‚Äôre viewing this document on a subdomain of \sphinxtitleref{.datro.world} you may need to right\sphinxhyphen{}click and select ‚Äòopen link in new tab\textasciigrave{}.
In the interim of a bug fix, you can avoid right\sphinxhyphen{}clicking all together, by viewing our document library at its original location \sphinxhref{https://gui.8cc.online/static/library}{gui.8cc.online/static/library}


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{Older Versions of this Document}\label{\detokenize{releasenotes:id5}}
\sphinxaftertopcaption
\begin{tabular}[t]{|\X{20}{100}|\X{20}{100}|\X{20}{100}|\X{40}{100}|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxstylestrong{Archive Date}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxstylestrong{Version}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxstylestrong{Description}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxstylestrong{Download Link}
\\
\hline&&&\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}
\end{quote}


\section{Known and Corrected Issues}
\label{\detokenize{releasenotes:known-and-corrected-issues}}
\sphinxAtStartPar
Below is a table of pending issues which have been reported to our team.
When these issues are remedied, or any significant changed made, a new release will be published.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{Known Issues}\label{\detokenize{releasenotes:id6}}
\sphinxaftertopcaption
\begin{tabular}[t]{|\X{20}{100}|\X{15}{100}|\X{25}{100}|\X{40}{100}|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxstylestrong{Date}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxstylestrong{Version}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxstylestrong{Subject}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxstylestrong{Description}
\\
\hline
\sphinxAtStartPar
2021
&
\sphinxAtStartPar
0.0.0
&
\sphinxAtStartPar
security
&
\sphinxAtStartPar
{\color{red}\bfseries{}\textasciigrave{}}Having the domes H3 cell reference/ location in HotspotBnB prior to it autonomouosly self\sphinxhyphen{}building is cool; but the solution must circumvent bad actors‚Äô
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\chapter{app\sphinxhyphen{}load}
\label{\detokenize{app-load:app-load}}\label{\detokenize{app-load::doc}}

\section{App load order}
\label{\detokenize{app-load:app-load-order}}
\sphinxAtStartPar
Old slow flow:

\sphinxhref{https://user-images.githubusercontent.com/2403652/73848963-00a2a080-4821-11ea-97d4-1200fc2638f3.png}{\sphinxincludegraphics{{ff329e6320567cbb1a6caa38f11cc2231260a890}.png}}

\sphinxAtStartPar
Current more parallel flow:

\sphinxhref{https://user-images.githubusercontent.com/2403652/83146440-303a2900-a0ee-11ea-806b-4f53f039b957.png}{\sphinxincludegraphics{{4c29914b0a040a9658c82a206beee1a02efe597f}.png}}



\sphinxAtStartPar
Key:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Parallelogram: async/await task

\item {} 
\sphinxAtStartPar
Box: sync task

\item {} 
\sphinxAtStartPar
Diamond: conditional branch

\item {} 
\sphinxAtStartPar
Egg: user interaction

\item {} 
\sphinxAtStartPar
Blue arrow: async task is allowed to settle but allowed to fail

\item {} 
\sphinxAtStartPar
Red arrow: async task success is asserted

\end{itemize}

\sphinxAtStartPar
Notes:
\begin{itemize}
\item {} 
\sphinxAtStartPar
A task begins when all its dependencies (arrows going into it) are fulfilled.

\item {} 
\sphinxAtStartPar
The success of setting up rageshake is never asserted, element\sphinxhyphen{}web has a fallback path for running without IDB (and thus rageshake).

\item {} 
\sphinxAtStartPar
Everything is awaited to be settled before the Modernizr check, to allow it to make use of things like i18n if they are successful.

\end{itemize}

\sphinxAtStartPar
Underlying dependencies:

\sphinxhref{https://user-images.githubusercontent.com/2403652/73848977-08624500-4821-11ea-9830-bb0317c41086.png}{\sphinxincludegraphics{{3b288ceb3c8a64dc428a2b1de3e40329a130c80a}.png}}


\chapter{config}
\label{\detokenize{config:config}}\label{\detokenize{config::doc}}

\section{Configuration}
\label{\detokenize{config:configuration}}
\sphinxAtStartPar
You can configure the app by copying \sphinxcode{\sphinxupquote{config.sample.json}} to
\sphinxcode{\sphinxupquote{config.json}} and customising it:

\sphinxAtStartPar
For a good example, see \sphinxurl{https://develop.element.io/config.json}.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{default\_server\_config}} sets the default homeserver and identity server URL for
Element to use. The object is the same as returned by \sphinxtitleref{https://:raw\sphinxhyphen{}html\sphinxhyphen{}m2r:\textasciigrave{}\textless{}server\_name\textgreater{}}/.well\sphinxhyphen{}known/matrix/client \textless{}\sphinxurl{https://matrix.org/docs/spec/client\_server/latest.html\#get-well-known-matrix-client}\textgreater{}\textasciigrave{}\_,
with added support for a \sphinxcode{\sphinxupquote{server\_name}} under the \sphinxcode{\sphinxupquote{m.homeserver}} section to display
a custom homeserver name. Alternatively, the config can contain a \sphinxcode{\sphinxupquote{default\_server\_name}}
instead which is where Element will go to get that same object, although this option is
deprecated \sphinxhyphen{} see the \sphinxcode{\sphinxupquote{.well\sphinxhyphen{}known}} link above for more information on using this option.
Note that the \sphinxcode{\sphinxupquote{default\_server\_name}} is used to get a complete server configuration
whereas the \sphinxcode{\sphinxupquote{server\_name}} in the \sphinxcode{\sphinxupquote{default\_server\_config}} is for display purposes only.
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleemphasis{Note}: The URLs can also be individually specified as \sphinxcode{\sphinxupquote{default\_hs\_url}} and
\sphinxcode{\sphinxupquote{default\_is\_url}}, however these are deprecated. They are maintained for backwards
compatibility with older configurations. \sphinxcode{\sphinxupquote{default\_is\_url}} is respected only
if \sphinxcode{\sphinxupquote{default\_hs\_url}} is used.

\item {} 
\sphinxAtStartPar
Element will fail to load if a mix of \sphinxcode{\sphinxupquote{default\_server\_config}}, \sphinxcode{\sphinxupquote{default\_server\_name}}, or
\sphinxcode{\sphinxupquote{default\_hs\_url}} is specified. When multiple sources are specified, it is unclear
which should take priority and therefore the application cannot continue.

\item {} 
\sphinxAtStartPar
As of Element 1.4.0, identity servers are optional. See {\hyperref[\detokenize{config:identity-servers}]{\emph{Identity servers}}} below.

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{sso\_immediate\_redirect}}: When \sphinxcode{\sphinxupquote{true}}, Element will assume the default server supports SSO
and attempt to send the user there to continue (if they aren‚Äôt already logged in). Default
\sphinxcode{\sphinxupquote{false}}. Note that this disables all usage of the welcome page.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{features}}: Lookup of optional features that may be force\sphinxhyphen{}enabled (\sphinxcode{\sphinxupquote{true}}) or force\sphinxhyphen{}disabled (\sphinxcode{\sphinxupquote{false}}).
When features are not listed here, their defaults will be used, and users can turn them on/off if \sphinxcode{\sphinxupquote{showLabsSettings}}
allows them to. The available optional experimental features vary from release to release and are
\sphinxhref{labs.md}{documented}. The feature flag process is \sphinxhref{feature-flags.md}{documented} as well.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{showLabsSettings}}: Shows the ‚Äúlabs‚Äù tab of user settings. Useful to allow users to turn on experimental features
they might not otherwise have access to.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{brand}}: String to pass to your homeserver when configuring email notifications, to let the
homeserver know what email template to use when talking to you.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{branding}: Configures various branding and logo details, such as:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumii}{enumiii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{welcomeBackgroundUrl}}: An image to use as a wallpaper outside the app
during authentication flows. If an array is passed, an image is chosen randomly for each visit.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{authHeaderLogoUrl}}: An logo image that is shown in the header during
authentication flows

\item {} 
\sphinxAtStartPar
\sphinxtitleref{authFooterLinks}: a list of links to show in the authentication page footer:
\sphinxcode{\sphinxupquote{{[}\{"text": "Link text", "url": "https://link.target"\}, \{"text": "Other link", ...\}{]}}}

\end{enumerate}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{reportEvent}}: Configures the dialog for reporting content to the homeserver
admin.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumii}{enumiii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{adminMessageMD}}: An extra message to show on the reporting dialog to
mention homeserver\sphinxhyphen{}specific policies. Accepts Markdown.

\end{enumerate}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{integrations\_ui\_url}}: URL to the web interface for the integrations server. The integrations
server is not Element and normally not your homeserver either. The integration server settings
may be left blank to disable integrations.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{integrations\_rest\_url}}: URL to the REST interface for the integrations server.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{integrations\_widgets\_urls}}: list of URLs to the REST interface for the widget integrations server.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{bug\_report\_endpoint\_url}}: endpoint to send bug reports to (must be running a
\sphinxurl{https://github.com/matrix-org/rageshake} server). Bug reports are sent when a user clicks
‚ÄúSend Logs‚Äù within the application. Bug reports can be disabled/hidden by leaving the
\sphinxcode{\sphinxupquote{bug\_report\_endpoint\_url}} out of your config file.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{roomDirectory}}: config for the public room directory. This section is optional.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{roomDirectory.servers}}: List of other homeservers‚Äô directories to include in the drop
down list. Optional.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{default\_theme}}: name of theme to use by default (e.g. ‚Äòlight‚Äô)

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{update\_base\_url}} (electron app only): HTTPS URL to a web server to download
updates from. This should be the path to the directory containing \sphinxcode{\sphinxupquote{macos}}
and \sphinxcode{\sphinxupquote{win32}} (for update packages, not installer packages).

\item {} 
\sphinxAtStartPar
\sphinxtitleref{piwik}: Analytics can be disabled by setting \sphinxtitleref{piwik: false\textasciigrave{}\textasciigrave{}or by leaving the piwik config
option out of your config file. If you want to enable analytics, set\textasciigrave{}}piwik\textasciigrave{} to be an object
containing the following properties:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumii}{enumiii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{url}}: The URL of the Piwik instance to use for collecting analytics

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{whitelistedHSUrls}}: a list of HS URLs to not redact from the analytics

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{whitelistedISUrls}}: a list of IS URLs to not redact from the analytics

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{siteId}}: The Piwik Site ID to use when sending analytics to the Piwik server configured above

\end{enumerate}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{welcomeUserId}}: the user ID of a bot to invite whenever users register that can give them a tour

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{embeddedPages}}: Configures the pages displayed in portions of Element that
embed static files, such as:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumii}{enumiii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{welcomeUrl}}: Initial content shown on the outside of the app when not
logged in. Defaults to \sphinxcode{\sphinxupquote{welcome.html}} supplied with Element.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{homeUrl}}: Content shown on the inside of the app when a specific room is
not selected. By default, no home page is configured. If one is set, a
button to access it will be shown in the top left menu.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{loginForWelcome}}: Overrides \sphinxcode{\sphinxupquote{welcomeUrl}} to make the welcome page be the
same page as the login page when \sphinxcode{\sphinxupquote{true}}. This effectively disables the
welcome page.

\end{enumerate}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{defaultCountryCode}}: The ISO 3166 alpha2 country code to use when showing
country selectors, like the phone number input on the registration page.
Defaults to \sphinxcode{\sphinxupquote{GB}} if the given code is unknown or not provided.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{settingDefaults}}:  Defaults for settings that support the \sphinxcode{\sphinxupquote{config}} level,
as an object mapping setting name to value (note that the ‚Äútheme‚Äù setting
is special cased to the \sphinxcode{\sphinxupquote{default\_theme}} in the config file).

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{disable\_custom\_urls}}: disallow the user to change the
default homeserver when signing up or logging in.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{permalinkPrefix}}: Used to change the URL that Element generates permalinks with.
By default, this is ‚Äú\sphinxurl{https://matrix.to}‚Äù to generate matrix.to (spec) permalinks.
Set this to your Element instance URL if you run an unfederated server (eg:
‚Äú\sphinxurl{https://element.example.org}‚Äù).

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{jitsi}}: Used to change the default conference options. Learn more about the
Jitsi options at \sphinxhref{./jitsi.md}{jitsi.md}.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumii}{enumiii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{preferredDomain}}: The domain name of the preferred Jitsi instance. Defaults
to \sphinxcode{\sphinxupquote{jitsi.riot.im}}. This is used whenever a user clicks on the voice/video
call buttons \sphinxhyphen{} integration managers may use a different domain.

\end{enumerate}

\item {} \begin{description}
\item[{\sphinxcode{\sphinxupquote{enable\_presence\_by\_hs\_url}}}] \leavevmode{[}The property key should be the URL of the homeserver{]}
\sphinxAtStartPar
and its value defines whether to enable/disable the presence status display
from that homeserver. If no options are configured, presence is shown for all
homeservers.

\end{description}

\item {} \begin{description}
\item[{\sphinxcode{\sphinxupquote{disable\_guests}}}] \leavevmode{[}Disables guest access tokens and auto\sphinxhyphen{}guest registrations.{]}
\sphinxAtStartPar
Defaults to false (guests are allowed).

\end{description}

\item {} \begin{description}
\item[{\sphinxcode{\sphinxupquote{disable\_login\_language\_selector}}}] \leavevmode{[}Disables the login language selector. Defaults{]}
\sphinxAtStartPar
to false (language selector is shown).

\end{description}

\item {} \begin{description}
\item[{\sphinxcode{\sphinxupquote{disable\_3pid\_login}}}] \leavevmode{[}Disables 3rd party identity options on login and registration form{]}
\sphinxAtStartPar
Defaults to false (3rd party identity options are shown).

\end{description}

\item {} \begin{description}
\item[{\sphinxcode{\sphinxupquote{default\_federate}}}] \leavevmode{[}Default option for room federation when creating a room{]}
\sphinxAtStartPar
Defaults to true (room federation enabled).

\end{description}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{desktopBuilds}}: Used to alter promotional links to the desktop app. By default
the builds are considered available and accessible from \sphinxurl{https://element.io}. This
config option is typically used in the context of encouraging encrypted message
search capabilities (Seshat). All the options listed below are required if this
option is specified.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumii}{enumiii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{available}}: When false, the desktop app will not be promoted to the user.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{logo}}: An HTTP URL to the avatar for the desktop build. Should be 24x24, ideally
an SVG.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{url}}: An HTTP URL for where to send the user to download the desktop build.

\end{enumerate}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{mobileBuilds}}: Used to alter promotional links to the mobile app. By default the
builds are considered available and accessible from \sphinxurl{https://element.io}. This config
option is typically used in a context of encouraging the user to try the mobile app
instead of a mobile/incompatible browser.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumii}{enumiii}{}{.}%
\item {} \begin{description}
\item[{\sphinxcode{\sphinxupquote{ios}}}] \leavevmode{[}The URL to the iOS build. If \sphinxcode{\sphinxupquote{null}}, it will be assumed to be not available.{]}
\sphinxAtStartPar
If not set, the default element.io builds will be used.

\end{description}

\item {} \begin{description}
\item[{\sphinxcode{\sphinxupquote{android}}}] \leavevmode{[}The URL to the Android build. If \sphinxcode{\sphinxupquote{null}}, it will be assumed to be not available.{]}
\sphinxAtStartPar
If not set, the default element.io builds will be used.

\end{description}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{fdroid}}: The URL to the FDroid build. If \sphinxcode{\sphinxupquote{null}}, it will be assumed to be not available.
If not set, the default element.io builds will be used.

\end{enumerate}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{mobileGuideToast}}: Whether to show a toast a startup which nudges users on
iOS and Android towards the native mobile apps. The toast redirects to the
mobile guide if they accept. Defaults to false.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{audioStreamUrl}}: If supplied, show an option on Jitsi widgets to stream
audio using Jitsi‚Äôs live streaming feature. This option is experimental and
may be removed at any time without notice.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{voip}}: Behaviour related to calls
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumii}{enumiii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{obeyAssertedIdentity}}: If set, MSC3086 asserted identity messages sent
on VoIP calls will cause the call to appear in the room corresponding to the
asserted identity. This \sphinxstyleemphasis{must} only be set in trusted environments.

\end{enumerate}

\item {} 
\sphinxAtStartPar
\sphinxtitleref{posthog}: {[}Posthog{]}(\sphinxurl{https://posthog.com/}) integration config. If not set, Posthog analytics are disabled.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumii}{enumiii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{projectApiKey}}: The Posthog project API key

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{apiHost}}: The Posthog API host

\end{enumerate}

\end{enumerate}

\sphinxAtStartPar
Note that \sphinxcode{\sphinxupquote{index.html}} also has an og:image meta tag that is set to an image
hosted on riot.im. This is the image used if links to your copy of Element
appear in some websites like Facebook, and indeed Element itself. This has to be
static in the HTML and an absolute URL (and HTTP rather than HTTPS), so it‚Äôs
not possible for this to be an option in config.json. If you‚Äôd like to change
it, you can build Element, but run
\sphinxcode{\sphinxupquote{RIOT\_OG\_IMAGE\_URL="http://example.com/logo.png" yarn build}}.
Alternatively, you can edit the \sphinxcode{\sphinxupquote{og:image}} meta tag in \sphinxcode{\sphinxupquote{index.html}} directly
each time you download a new version of Element.


\section{Identity servers}
\label{\detokenize{config:id2}}
\sphinxAtStartPar
The identity server is used for inviting other users to a room via third party
identifiers like emails and phone numbers. It is not used to store your password
or account information.

\sphinxAtStartPar
As of Element 1.4.0, all identity server functions are optional and you are
prompted to agree to terms before data is sent to the identity server.

\sphinxAtStartPar
Element will check multiple sources when looking for an identity server to use in
the following order of preference:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
The identity server set in the user‚Äôs account data
\begin{itemize}
\item {} 
\sphinxAtStartPar
For a new user, no value is present in their account data. It is only set
if the user visits Settings and manually changes their identity server.

\end{itemize}

\item {} 
\sphinxAtStartPar
The identity server provided by the \sphinxcode{\sphinxupquote{.well\sphinxhyphen{}known}} lookup that occurred at
login

\item {} 
\sphinxAtStartPar
The identity server provided by the Riot config file

\end{enumerate}

\sphinxAtStartPar
If none of these sources have an identity server set, then Element will prompt the
user to set an identity server first when attempting to use features that
require one.

\sphinxAtStartPar
Currently, the only two public identity servers are \sphinxurl{https://vector.im} and
\sphinxurl{https://matrix.org}, however in the future identity servers will be
decentralised.


\section{Desktop app configuration}
\label{\detokenize{config:desktop-app-configuration}}
\sphinxAtStartPar
See \sphinxurl{https://github.com/vector-im/element-desktop\#user-specified-configjson}


\section{UI Features}
\label{\detokenize{config:ui-features}}
\sphinxAtStartPar
Parts of the UI can be disabled using UI features. These are settings which appear
under \sphinxcode{\sphinxupquote{settingDefaults}} and can only be \sphinxcode{\sphinxupquote{true}} (default) or \sphinxcode{\sphinxupquote{false}}. When \sphinxcode{\sphinxupquote{false}},
parts of the UI relating to that feature will be disabled regardless of the user‚Äôs
preferences.

\sphinxAtStartPar
Currently, the following UI feature flags are supported:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{UIFeature.urlPreviews}} \sphinxhyphen{} Whether URL previews are enabled across the entire application.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{UIFeature.feedback}} \sphinxhyphen{} Whether prompts to supply feedback are shown.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{UIFeature.voip}} \sphinxhyphen{} Whether or not VoIP is shown readily to the user. When disabled,
Jitsi widgets will still work though they cannot easily be added.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{UIFeature.widgets}} \sphinxhyphen{} Whether or not widgets will be shown.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{UIFeature.flair}} \sphinxhyphen{} Whether or not community flair is shown in rooms.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{UIFeature.communities}} \sphinxhyphen{} Whether or not to show any UI related to communities. Implicitly
disables \sphinxcode{\sphinxupquote{UIFeature.flair}} when disabled.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{UIFeature.advancedSettings}} \sphinxhyphen{} Whether or not sections titled ‚Äúadvanced‚Äù in room and
user settings are shown to the user.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{UIFeature.shareQrCode}} \sphinxhyphen{} Whether or not the QR code on the share room/event dialog
is shown.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{UIFeature.shareSocial}} \sphinxhyphen{} Whether or not the social icons on the share room/event dialog
are shown.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{UIFeature.identityServer}} \sphinxhyphen{} Whether or not functionality requiring an identity server
is shown. When disabled, the user will not be able to interact with the identity
server (sharing email addresses, 3PID invites, etc).

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{UIFeature.thirdPartyId}} \sphinxhyphen{} Whether or not UI relating to third party identifiers (3PIDs)
is shown. Typically this is considered ‚Äúcontact information‚Äù on the homeserver, and is
not directly related to the identity server.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{UIFeature.registration}} \sphinxhyphen{} Whether or not the registration page is accessible. Typically
useful if accounts are managed externally.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{UIFeature.passwordReset}} \sphinxhyphen{} Whether or not the password reset page is accessible. Typically
useful if accounts are managed externally.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{UIFeature.deactivate}} \sphinxhyphen{} Whether or not the deactivate account button is accessible. Typically
useful if accounts are managed externally.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{UIFeature.advancedEncryption}} \sphinxhyphen{} Whether or not advanced encryption options are shown to the
user.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{UIFeature.roomHistorySettings}} \sphinxhyphen{} Whether or not the room history settings are shown to the user.
This should only be used if the room history visibility options are managed by the server.

\end{itemize}


\chapter{customisations}
\label{\detokenize{customisations:customisations}}\label{\detokenize{customisations::doc}}

\section{Customisations}
\label{\detokenize{customisations:id1}}
\sphinxAtStartPar
Element Web and the React SDK support ‚Äúcustomisation points‚Äù that can be used to
easily add custom logic specific to a particular deployment of Element Web.

\sphinxAtStartPar
An example of this is the \sphinxhref{https://github.com/matrix-org/matrix-react-sdk/blob/develop/src/customisations/Security.ts}{security customisations
module}.
This module in the React SDK only defines some empty functions and their types:
it does not do anything by default.

\sphinxAtStartPar
To make use of these customisation points, you will first need to fork Element
Web so that you can add your own code. Even though the default module is part of
the React SDK, you can still override it from the Element Web layer:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Copy the default customisation module to
\sphinxcode{\sphinxupquote{element\sphinxhyphen{}web/src/customisations/YourNameSecurity.ts}}

\item {} 
\sphinxAtStartPar
Edit customisations points and make sure export the ones you actually want to
activate

\item {} 
\sphinxAtStartPar
Tweak the Element build process to use the customised module instead of the
default by adding this to the \sphinxcode{\sphinxupquote{additionalPlugins}} array in \sphinxcode{\sphinxupquote{webpack.config.js}}:

\end{enumerate}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{new} \PYG{n+nx}{webpack}\PYG{p}{.}\PYG{n+nx}{NormalModuleReplacementPlugin}\PYG{p}{(}
    \PYG{l+s+sr}{/src[\PYGZbs{}/\PYGZbs{}\PYGZbs{}]customisations[\PYGZbs{}/\PYGZbs{}\PYGZbs{}]Security\PYGZbs{}.ts/}\PYG{p}{,}
    \PYG{n+nx}{path}\PYG{p}{.}\PYG{n+nx}{resolve}\PYG{p}{(}\PYG{n+nx}{\PYGZus{}\PYGZus{}dirname}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}src/customisations/YourNameSecurity.ts\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
\PYG{p}{)}\PYG{p}{,}
\end{sphinxVerbatim}

\sphinxAtStartPar
If we add more customisation modules in the future, we‚Äôll likely improve these
steps to remove the need for build changes like the above.

\sphinxAtStartPar
By isolating customisations to their own module, this approach should remove the
chance of merge conflicts when updating your fork, and thus simplify ongoing
maintenance.


\chapter{e2ee}
\label{\detokenize{e2ee:e2ee}}\label{\detokenize{e2ee::doc}}

\section{End to end encryption by default}
\label{\detokenize{e2ee:end-to-end-encryption-by-default}}
\sphinxAtStartPar
By default, Element will create encrypted DM rooms if the user you are chatting with has keys uploaded on their account.
For private room creation, Element will default to encryption on but give you the choice to opt\sphinxhyphen{}out.


\chapter{Disabling encryption by default}
\label{\detokenize{e2ee:disabling-encryption-by-default}}
\sphinxAtStartPar
Set the following on your homeserver‚Äôs
\sphinxcode{\sphinxupquote{/.well\sphinxhyphen{}known/matrix/client}} config:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{\PYGZob{}}
  \PYG{n+nt}{\PYGZdq{}io.element.e2ee\PYGZdq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
    \PYG{n+nt}{\PYGZdq{}default\PYGZdq{}}\PYG{p}{:} \PYG{k+kc}{false}
  \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\section{Secure backup}
\label{\detokenize{e2ee:secure-backup}}
\sphinxAtStartPar
By default, Element strongly encourages (but does not require) users to set up
Secure Backup so that cross\sphinxhyphen{}signing identity key and message keys can be
recovered in case of a disaster where you lose access to all active devices.


\chapter{Requiring secure backup}
\label{\detokenize{e2ee:requiring-secure-backup}}
\sphinxAtStartPar
To require Secure Backup to be configured before Element can be used, set the
following on your homeserver‚Äôs \sphinxcode{\sphinxupquote{/.well\sphinxhyphen{}known/matrix/client}} config:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{\PYGZob{}}
  \PYG{n+nt}{\PYGZdq{}io.element.e2ee\PYGZdq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
    \PYG{n+nt}{\PYGZdq{}secure\PYGZus{}backup\PYGZus{}required\PYGZdq{}}\PYG{p}{:} \PYG{k+kc}{true}
  \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\chapter{Preferring setup methods}
\label{\detokenize{e2ee:preferring-setup-methods}}
\sphinxAtStartPar
By default, Element offers users a choice of a random key or user\sphinxhyphen{}chosen
passphrase when setting up Secure Backup. If a homeserver admin would like to
only offer one of these, you can signal this via the
\sphinxcode{\sphinxupquote{/.well\sphinxhyphen{}known/matrix/client}} config, for example:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{\PYGZob{}}
  \PYG{n+nt}{\PYGZdq{}io.element.e2ee\PYGZdq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
    \PYG{n+nt}{\PYGZdq{}secure\PYGZus{}backup\PYGZus{}setup\PYGZus{}methods\PYGZdq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}passphrase\PYGZdq{}}\PYG{p}{]}
  \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

\sphinxAtStartPar
The field \sphinxcode{\sphinxupquote{secure\_backup\_setup\_methods}} is an array listing the methods the
client should display. Supported values currently include \sphinxcode{\sphinxupquote{key}} and
\sphinxcode{\sphinxupquote{passphrase}}. If the \sphinxcode{\sphinxupquote{secure\_backup\_setup\_methods}} field is not present or
exists but does not contain any supported methods, Element will fallback to the
default value of: \sphinxcode{\sphinxupquote{{[}"key", "passphrase"{]}}}.


\section{Compatibility}
\label{\detokenize{e2ee:compatibility}}
\sphinxAtStartPar
The settings above were first proposed under a \sphinxcode{\sphinxupquote{im.vector.riot.e2ee}} key, which
is now deprecated. Element will check for either key, preferring
\sphinxcode{\sphinxupquote{io.element.e2ee}} if both exist.


\chapter{feature\sphinxhyphen{}flags}
\label{\detokenize{feature-flags:feature-flags}}\label{\detokenize{feature-flags::doc}}

\section{Feature flags}
\label{\detokenize{feature-flags:id1}}
\sphinxAtStartPar
When developing new features for Element, we use feature flags to give us more
flexibility and control over when and where those features are enabled.

\sphinxAtStartPar
For example, flags make the following things possible:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Extended testing of a feature via labs on develop

\item {} 
\sphinxAtStartPar
Enabling features when ready instead of the first moment the code is released

\item {} 
\sphinxAtStartPar
Testing a feature with a specific set of users (by enabling only on a specific
Element instance)

\end{itemize}

\sphinxAtStartPar
The size of the feature controlled by a feature flag may vary widely: it could
be a large project like reactions or a smaller change to an existing algorithm.
A large project might use several feature flags if it‚Äôs useful to control the
deployment of different portions independently.

\sphinxAtStartPar
Everyone involved in a feature (engineering, design, product, reviewers) should
think about its deployment plan up front as best as possible so we can have the
right feature flags in place from the start.


\chapter{Interaction with spec process}
\label{\detokenize{feature-flags:interaction-with-spec-process}}
\sphinxAtStartPar
Historically, we have often used feature flags to guard client features that
depend on unstable spec features. Unfortunately, there was never clear agreement
about how long such a flag should live for, when it should be removed, etc.

\sphinxAtStartPar
Under the \sphinxhref{https://github.com/matrix-org/matrix-doc/pull/2324}{new spec
process}, server\sphinxhyphen{}side
unstable features can be used by clients and enabled by default as long as
clients commit to doing the associated clean up work once a feature stabilises.


\chapter{Starting work on a feature}
\label{\detokenize{feature-flags:starting-work-on-a-feature}}
\sphinxAtStartPar
When starting work on a feature, we should create a matching feature flag:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Add a new
\sphinxhref{https://github.com/matrix-org/matrix-react-sdk/blob/develop/src/settings/Settings.ts}{setting}
of the form:
.. code\sphinxhyphen{}block:: js
\begin{quote}
\begin{description}
\item[{‚Äúfeature\_cats‚Äù: \{}] \leavevmode
\sphinxAtStartPar
isFeature: true,
displayName: \_td(‚ÄúAdds cats everywhere‚Äù),
supportedLevels: LEVELS\_FEATURE,
default: false,

\end{description}

\sphinxAtStartPar
\},
\end{quote}

\item {} 
\sphinxAtStartPar
Check whether the feature is enabled as appropriate:
.. code\sphinxhyphen{}block:: js
\begin{quote}

\sphinxAtStartPar
SettingsStore.getValue(‚Äúfeature\_cats‚Äù)
\end{quote}

\item {} 
\sphinxAtStartPar
Document the feature in the \sphinxhref{https://github.com/vector-im/element-web/blob/develop/docs/labs.md}{labs documentation}

\end{enumerate}

\sphinxAtStartPar
With these steps completed, the feature is disabled by default, but can be
enabled on develop and nightly by interested users for testing.

\sphinxAtStartPar
Different features may have different deployment plans for when to enable where.
The following lists a few common options.


\chapter{Enabling by default on develop and nightly}
\label{\detokenize{feature-flags:enabling-by-default-on-develop-and-nightly}}
\sphinxAtStartPar
Set the feature to \sphinxcode{\sphinxupquote{true}} in the
\sphinxhref{https://github.com/vector-im/element-web/blob/develop/element.io/develop/config.json}{develop}
and
\sphinxhref{https://github.com/vector-im/element-desktop/blob/develop/element.io/nightly/config.json}{nightly}
configs:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nt}{\PYGZdq{}features\PYGZdq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
    \PYG{n+nt}{\PYGZdq{}feature\PYGZus{}cats\PYGZdq{}}\PYG{p}{:} \PYG{k+kc}{true}
\PYG{p}{\PYGZcb{},}
\end{sphinxVerbatim}


\chapter{Enabling by default on staging, app, and release}
\label{\detokenize{feature-flags:enabling-by-default-on-staging-app-and-release}}
\sphinxAtStartPar
Set the feature to \sphinxcode{\sphinxupquote{true}} in the
\sphinxhref{https://github.com/vector-im/element-web/blob/develop/element.io/app/config.json}{staging / app}
and
\sphinxhref{https://github.com/vector-im/element-desktop/blob/develop/element.io/release/config.json}{release}
configs.

\sphinxAtStartPar
\sphinxstylestrong{Note:} The above will only enable the feature for \sphinxurl{https://app.element.io} and official Element
Desktop builds. It will not be enabled for self\sphinxhyphen{}hosted installed, custom desktop builds, etc. To
cover these cases, change the setting‚Äôs \sphinxcode{\sphinxupquote{default}} in \sphinxcode{\sphinxupquote{Settings.ts}} to \sphinxcode{\sphinxupquote{true}}.


\chapter{Feature deployed successfully}
\label{\detokenize{feature-flags:feature-deployed-successfully}}
\sphinxAtStartPar
Once we‚Äôre confident that a feature is working well, we should remove or convert the flag.

\sphinxAtStartPar
If the feature is meant to be turned off/on by the user:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Remove \sphinxcode{\sphinxupquote{isFeature}} from the \sphinxhref{https://github.com/matrix-org/matrix-react-sdk/blob/develop/src/settings/Settings.ts}{setting}

\item {} 
\sphinxAtStartPar
Change the \sphinxcode{\sphinxupquote{default}} to \sphinxcode{\sphinxupquote{true}} (if desired).

\item {} 
\sphinxAtStartPar
Remove the feature from the \sphinxhref{https://github.com/vector-im/element-web/blob/develop/docs/labs.md}{labs documentation}

\item {} 
\sphinxAtStartPar
Celebrate! ü•≥

\end{enumerate}

\sphinxAtStartPar
If the feature is meant to be forced on (non\sphinxhyphen{}configurable):
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Remove the \sphinxhref{https://github.com/matrix-org/matrix-react-sdk/blob/develop/src/settings/Settings.ts}{setting}

\item {} 
\sphinxAtStartPar
Remove all \sphinxcode{\sphinxupquote{getValue}} lines that test for the feature.

\item {} 
\sphinxAtStartPar
Remove the feature from the \sphinxhref{https://github.com/vector-im/element-web/blob/develop/docs/labs.md}{labs documentation}

\item {} 
\sphinxAtStartPar
If applicable, remove the feature state from
\sphinxhref{https://github.com/vector-im/element-web/blob/develop/element.io/develop/config.json}{develop},
\sphinxhref{https://github.com/vector-im/element-desktop/blob/develop/element.io/nightly/config.json}{nightly},
\sphinxhref{https://github.com/vector-im/element-web/blob/develop/element.io/app/config.json}{staging / app},
and
\sphinxhref{https://github.com/vector-im/element-desktop/blob/develop/element.io/release/config.json}{release}
configs

\item {} 
\sphinxAtStartPar
Celebrate! ü•≥

\end{enumerate}


\chapter{jitsi\sphinxhyphen{}dev}
\label{\detokenize{jitsi-dev:jitsi-dev}}\label{\detokenize{jitsi-dev::doc}}

\section{Jitsi wrapper developer docs}
\label{\detokenize{jitsi-dev:jitsi-wrapper-developer-docs}}
\sphinxAtStartPar
\sphinxstyleemphasis{If you‚Äôre looking for information on how to set up Jitsi in your Element, see
\textasciigrave{}jitsi.md \textless{}./jitsi.md\textgreater{}\textasciigrave{}\_ instead.}

\sphinxAtStartPar
These docs are for developers wondering how the different conference buttons work
within Element. If you‚Äôre not a developer, you‚Äôre probably looking for \sphinxhref{./jitsi.md}{jitsi.md}.


\chapter{Brief introduction to widgets}
\label{\detokenize{jitsi-dev:brief-introduction-to-widgets}}
\sphinxAtStartPar
Widgets are embedded web applications in a room, controlled through state events, and
have a \sphinxcode{\sphinxupquote{url}} property. They are largely specified by \sphinxhref{https://github.com/matrix-org/matrix-doc/issues/1236}{MSC1236}
and have extensions proposed under \sphinxhref{https://github.com/matrix-org/matrix-doc/issues/1286}{MSC1286}.

\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{url}} is typically something we shove into an iframe with sandboxing (see \sphinxcode{\sphinxupquote{AppTile}}
in the react\sphinxhyphen{}sdk), though for some widgets special integration can be done. v2 widgets
have a \sphinxcode{\sphinxupquote{data}} object which helps achieve that special integration, though v1 widgets
are best iframed and left alone.

\sphinxAtStartPar
Widgets have a \sphinxcode{\sphinxupquote{postMessage}} API they can use to interact with Element, which also allows
Element to interact with them. Typically this is most used by the sticker picker (an
account\sphinxhyphen{}level widget), though widgets like the Jitsi widget will request permissions to
get ‚Äòstuck‚Äô into the room list during a conference.

\sphinxAtStartPar
Widgets can be added with the \sphinxcode{\sphinxupquote{/addwidget \textless{}url\textgreater{}}} command.


\chapter{Brief introduction to integration managers}
\label{\detokenize{jitsi-dev:brief-introduction-to-integration-managers}}
\sphinxAtStartPar
Integration managers (like Scalar and Dimension) are accessible via the 4 squares in
the top right of the room and provide a simple UI over top of bridges, bots, and other
stuff to plug into a room. They are a separate service to Element and are thus iframed
in a dialog as well. They also have a \sphinxcode{\sphinxupquote{postMessage}} API they can use to interact with
the client to create things like widgets, give permissions to bridges, and generally
set everything up for the integration the user is working with.

\sphinxAtStartPar
Integration managers do not currently have a spec associated with them, though efforts
are underway in \sphinxhref{https://github.com/matrix-org/matrix-doc/issues/1286}{MSC1286}.


\chapter{Widgets configured by integration managers}
\label{\detokenize{jitsi-dev:widgets-configured-by-integration-managers}}
\sphinxAtStartPar
Integration managers will often ‚Äúwrap‚Äù a widget by using a widget \sphinxcode{\sphinxupquote{url}} which points
to the integration manager instead of to where the user requested the widget be. For
example, a custom widget added in an integration manager for \sphinxurl{https://matrix.org} will
end up creating a widget with a URL like \sphinxcode{\sphinxupquote{https://integrations.example.org?widgetUrl=https\%3A\%2F\%2Fmatrix.org}}.

\sphinxAtStartPar
The integration manager‚Äôs wrapper will typically have another iframe to isolate the
widget from the client by yet another layer. The wrapper often provides other functionality
which might not be available on the embedded site, such as a fullscreen button or the
communication layer with the client (all widgets \sphinxstyleemphasis{should} be talking to the client
over \sphinxcode{\sphinxupquote{postMessage}}, even if they aren‚Äôt going to be using the widget APIs).

\sphinxAtStartPar
Widgets added with the \sphinxcode{\sphinxupquote{/addwidget}} command will \sphinxstyleemphasis{not} be wrapped as they are not going
through an integration manager. The widgets themselves \sphinxstyleemphasis{should} also work outside of
Element. Widgets currently have a ‚Äúpop out‚Äù button which opens them in a new tab and
therefore have no connection back to Riot.


\chapter{Jitsi widgets from integration managers}
\label{\detokenize{jitsi-dev:jitsi-widgets-from-integration-managers}}
\sphinxAtStartPar
Integration managers will create an entire widget event and send it over \sphinxcode{\sphinxupquote{postMessage}}
for the client to add to the room. This means that the integration manager gets to
decide the conference domain, conference name, and other aspects of the widget. As
a result, users can end up with a Jitsi widget that does not use the same conference
server they specified in their config.json \sphinxhyphen{} this is expected.

\sphinxAtStartPar
Some integration managers allow the user to change the conference name while others
will generate one for the user.


\chapter{Jitsi widgets generated by Element itself}
\label{\detokenize{jitsi-dev:jitsi-widgets-generated-by-element-itself}}
\sphinxAtStartPar
When the user clicks on the call buttons by the composer, the integration manager is
not involved in the slightest. Instead, Element itself generates a widget event, this time
using the config.json parameters, and publishes that to the room. If there‚Äôs only two
people in the room, a plain WebRTC call is made instead of using a widget at all \sphinxhyphen{} these
are defined in the Matrix specification.

\sphinxAtStartPar
The Jitsi widget created by Element uses a local \sphinxcode{\sphinxupquote{jitsi.html}} wrapper (or one hosted by
\sphinxcode{\sphinxupquote{https://app.element.io}} for desktop users or those on non\sphinxhyphen{}https domains) as the widget
\sphinxcode{\sphinxupquote{url}}. The wrapper has some basic functionality for talking to Element to ensure the
required \sphinxcode{\sphinxupquote{postMessage}} calls are fulfilled.

\sphinxAtStartPar
\sphinxstylestrong{Note}: Per \sphinxhref{./jitsi.md}{jitsi.md} the \sphinxcode{\sphinxupquote{preferredDomain}} can also come from the server‚Äôs
client .well\sphinxhyphen{}known data.


\chapter{The Jitsi wrapper in Element}
\label{\detokenize{jitsi-dev:the-jitsi-wrapper-in-element}}
\sphinxAtStartPar
Whenever Element sees a Jitsi widget, it ditches the \sphinxcode{\sphinxupquote{url}} and instead replaces it with
its local wrapper, much like what it would do when creating a widget. However, instead
of using one from \sphinxhref{https://app.element.io}{app.element.io}, it will use one local to the client instead.

\sphinxAtStartPar
The wrapper is used to provide a consistent experience to users, as well as being faster
and less risky to load. The local wrapper URL is populated with the conference information
from the original widget (which could be a v1 or v2 widget) so the user joins the right
call.

\sphinxAtStartPar
Critically, when the widget URL is reconstructed it does \sphinxstyleemphasis{not} take into account the
config.json‚Äôs \sphinxcode{\sphinxupquote{preferredDomain}} for Jitsi. If it did this, users would end up on different
conference servers and therefore different calls entirely.

\sphinxAtStartPar
\sphinxstylestrong{Note}: Per \sphinxhref{./jitsi.md}{jitsi.md} the \sphinxcode{\sphinxupquote{preferredDomain}} can also come from the server‚Äôs
client .well\sphinxhyphen{}known data.


\chapter{jitsi}
\label{\detokenize{jitsi:jitsi}}\label{\detokenize{jitsi::doc}}

\section{Jitsi in Element}
\label{\detokenize{jitsi:jitsi-in-element}}
\sphinxAtStartPar
Element uses \sphinxhref{https://jitsi.org/}{Jitsi} for conference calls, which provides options for
self\sphinxhyphen{}hosting your own server and supports most major platforms.

\sphinxAtStartPar
1:1 calls, or calls between you and one other person, do not use Jitsi. Instead, those
calls work directly between clients or via TURN servers configured on the respective
homeservers.

\sphinxAtStartPar
There‚Äôs a number of ways to start a Jitsi call: the easiest way is to click on the
voice or video buttons near the message composer in a room with more than 2 people. This
will add a Jitsi widget which allows anyone in the room to join.

\sphinxAtStartPar
Integration managers (available through the 4 squares in the top right of the room) may
provide their own approaches for adding Jitsi widgets.


\chapter{Configuring Element to use your self\sphinxhyphen{}hosted Jitsi server}
\label{\detokenize{jitsi:configuring-element-to-use-your-self-hosted-jitsi-server}}
\sphinxAtStartPar
Element will use the Jitsi server that is embedded in the widget, even if it is not the
one you configured. This is because conference calls must be held on a single Jitsi
server and cannot be split over multiple servers.

\sphinxAtStartPar
However, you can configure Element to \sphinxstyleemphasis{start} a conference with your Jitsi server by adding
to your \sphinxhref{./config.md}{config} the following:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{\PYGZob{}}
  \PYG{n+nt}{\PYGZdq{}jitsi\PYGZdq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
    \PYG{n+nt}{\PYGZdq{}preferredDomain\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}your.jitsi.example.org\PYGZdq{}}
  \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

\sphinxAtStartPar
The default is \sphinxcode{\sphinxupquote{jitsi.riot.im}} (a free service offered by Element), and the demo site for
Jitsi uses \sphinxcode{\sphinxupquote{meet.jit.si}} (also free).

\sphinxAtStartPar
Once you‚Äôve applied the config change, refresh Element and press the call button. This
should start a new conference on your Jitsi server.

\sphinxAtStartPar
\sphinxstylestrong{Note}: The widget URL will point to a \sphinxcode{\sphinxupquote{jitsi.html}} page hosted by Element. The Jitsi
domain will appear later in the URL as a configuration parameter.

\sphinxAtStartPar
\sphinxstylestrong{Hint}: If you want everyone on your homeserver to use the same Jitsi server by
default, and you are using element\sphinxhyphen{}web 1.6 or newer, set the following on your homeserver‚Äôs
\sphinxcode{\sphinxupquote{/.well\sphinxhyphen{}known/matrix/client}} config:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{\PYGZob{}}
  \PYG{n+nt}{\PYGZdq{}im.vector.riot.jitsi\PYGZdq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
    \PYG{n+nt}{\PYGZdq{}preferredDomain\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}your.jitsi.example.org\PYGZdq{}}
  \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\chapter{Element Android}
\label{\detokenize{jitsi:element-android}}
\sphinxAtStartPar
Element Android (1.0.5+) supports custom Jitsi domains, similar to Element Web above.

\sphinxAtStartPar
1:1 calls, or calls between you and one other person, do not use Jitsi. Instead, those
calls work directly between clients or via TURN servers configured on the respective
homeservers.

\sphinxAtStartPar
For rooms with more than 2 joined members, when creating a Jitsi conference via call/video buttons of the toolbar (not via integration manager), Element Android will create a widget using the \sphinxhref{https://github.com/vector-im/element-web/blob/develop/docs/jitsi-dev.md}{wrapper} hosted on \sphinxcode{\sphinxupquote{app.element.io}}.
The domain used is the one specified by the \sphinxcode{\sphinxupquote{/.well\sphinxhyphen{}known/matrix/client}} endpoint, and if not present it uses the fallback defined in \sphinxcode{\sphinxupquote{config.xml}} (jitsi.riot.im)

\sphinxAtStartPar
For active Jitsi widgets in the room, a native Jitsi widget UI is created and points to the instance specified in the \sphinxcode{\sphinxupquote{domain}} key of the widget content data.

\sphinxAtStartPar
Element Android manages allowed native widgets permissions a bit differently than web widgets (as the data shared are different and never shared with the widget URL). For Jitsi widgets, permissions are requested only once per domain (consent saved in account data).


\chapter{Element iOS}
\label{\detokenize{jitsi:element-ios}}
\sphinxAtStartPar
Currently the Element mobile apps do not support custom Jitsi servers and will instead
use the default \sphinxcode{\sphinxupquote{jitsi.riot.im}} server. When users on the mobile apps join the call,
they will be joining a different conference which has the same name, but not the same
participants. This is a known bug and which needs to be fixed.


\chapter{kubernetes}
\label{\detokenize{kubernetes:kubernetes}}\label{\detokenize{kubernetes::doc}}

\section{Running in Kubernetes}
\label{\detokenize{kubernetes:running-in-kubernetes}}
\sphinxAtStartPar
In case you would like to deploy element\sphinxhyphen{}web in a kubernetes cluster you can use
the provided Kubernetes example below as a starting point. Note that this example assumes the
Nginx ingress to be installed.

\sphinxAtStartPar
Note that the content of the required \sphinxcode{\sphinxupquote{config.json}} is defined inside this yaml because it needs
to be put in your Kubernetes cluster as a \sphinxcode{\sphinxupquote{ConfigMap}}.

\sphinxAtStartPar
So to use it you must create a file with this content as a starting point and modify it so it meets
the requirements of your environment.

\sphinxAtStartPar
Then you can deploy it to your cluster with something like \sphinxcode{\sphinxupquote{kubectl apply \sphinxhyphen{}f my\sphinxhyphen{}element\sphinxhyphen{}web.yaml}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} This is an example of a POSSIBLE config for deploying a single element\PYGZhy{}web instance in Kubernetes}

\PYG{c+c1}{\PYGZsh{} Use the element\PYGZhy{}web namespace to put it all in.}

\PYG{n}{apiVersion}\PYG{p}{:} \PYG{n}{v1}
\PYG{n}{kind}\PYG{p}{:} \PYG{n}{Namespace}
\PYG{n}{metadata}\PYG{p}{:}
  \PYG{n}{name}\PYG{p}{:} \PYG{n}{element}\PYG{o}{\PYGZhy{}}\PYG{n}{web}

\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}

\PYG{c+c1}{\PYGZsh{} The config.json file is to be put into Kubernetes as a config file in such a way that}
\PYG{c+c1}{\PYGZsh{} the element web instance can read it.}
\PYG{c+c1}{\PYGZsh{} The code below shows how this can be done with the config.sample.json content.}

\PYG{n}{apiVersion}\PYG{p}{:} \PYG{n}{v1}
\PYG{n}{kind}\PYG{p}{:} \PYG{n}{ConfigMap}
\PYG{n}{metadata}\PYG{p}{:}
  \PYG{n}{name}\PYG{p}{:} \PYG{n}{element}\PYG{o}{\PYGZhy{}}\PYG{n}{config}
  \PYG{n}{namespace}\PYG{p}{:} \PYG{n}{element}\PYG{o}{\PYGZhy{}}\PYG{n}{web}
\PYG{n}{data}\PYG{p}{:}
  \PYG{n}{config}\PYG{o}{.}\PYG{n}{json}\PYG{p}{:} \PYG{o}{|}
    \PYG{p}{\PYGZob{}}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{default\PYGZus{}server\PYGZus{}config}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{m.homeserver}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{base\PYGZus{}url}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{https://matrix\PYGZhy{}client.matrix.org}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{server\PYGZus{}name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{matrix.org}\PYG{l+s+s2}{\PYGZdq{}}
            \PYG{p}{\PYGZcb{}}\PYG{p}{,}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{m.identity\PYGZus{}server}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{base\PYGZus{}url}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{https://vector.im}\PYG{l+s+s2}{\PYGZdq{}}
            \PYG{p}{\PYGZcb{}}
        \PYG{p}{\PYGZcb{}}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{disable\PYGZus{}custom\PYGZus{}urls}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{false}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{disable\PYGZus{}guests}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{false}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{disable\PYGZus{}login\PYGZus{}language\PYGZus{}selector}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{false}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{disable\PYGZus{}3pid\PYGZus{}login}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{false}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{brand}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Element}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{integrations\PYGZus{}ui\PYGZus{}url}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{https://scalar.vector.im/}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{integrations\PYGZus{}rest\PYGZus{}url}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{https://scalar.vector.im/api}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{integrations\PYGZus{}widgets\PYGZus{}urls}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{[}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{https://scalar.vector.im/\PYGZus{}matrix/integrations/v1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{https://scalar.vector.im/api}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{https://scalar\PYGZhy{}staging.vector.im/\PYGZus{}matrix/integrations/v1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{https://scalar\PYGZhy{}staging.vector.im/api}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{https://scalar\PYGZhy{}staging.riot.im/scalar/api}\PYG{l+s+s2}{\PYGZdq{}}
        \PYG{p}{]}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{bug\PYGZus{}report\PYGZus{}endpoint\PYGZus{}url}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{https://element.io/bugreports/submit}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{defaultCountryCode}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{GB}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{showLabsSettings}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{false}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{features}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}} \PYG{p}{\PYGZcb{}}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{default\PYGZus{}federate}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{true}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{default\PYGZus{}theme}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{light}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{roomDirectory}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{servers}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{[}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{matrix.org}\PYG{l+s+s2}{\PYGZdq{}}
            \PYG{p}{]}
        \PYG{p}{\PYGZcb{}}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{piwik}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{url}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{https://piwik.riot.im/}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{whitelistedHSUrls}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{https://matrix.org}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{whitelistedISUrls}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{https://vector.im}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{https://matrix.org}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{siteId}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+m+mi}{1}
        \PYG{p}{\PYGZcb{}}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{enable\PYGZus{}presence\PYGZus{}by\PYGZus{}hs\PYGZus{}url}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{https://matrix.org}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{false}\PYG{p}{,}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{https://matrix\PYGZhy{}client.matrix.org}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{false}
        \PYG{p}{\PYGZcb{}}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{settingDefaults}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{breadcrumbs}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{true}
        \PYG{p}{\PYGZcb{}}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{jitsi}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{preferredDomain}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{jitsi.riot.im}\PYG{l+s+s2}{\PYGZdq{}}
        \PYG{p}{\PYGZcb{}}
    \PYG{p}{\PYGZcb{}}


\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}

\PYG{c+c1}{\PYGZsh{} A deployment of the element\PYGZhy{}web for a single instance}

\PYG{n}{apiVersion}\PYG{p}{:} \PYG{n}{apps}\PYG{o}{/}\PYG{n}{v1}
\PYG{n}{kind}\PYG{p}{:} \PYG{n}{Deployment}
\PYG{n}{metadata}\PYG{p}{:}
  \PYG{n}{name}\PYG{p}{:} \PYG{n}{element}
  \PYG{n}{namespace}\PYG{p}{:} \PYG{n}{element}\PYG{o}{\PYGZhy{}}\PYG{n}{web}
\PYG{n}{spec}\PYG{p}{:}
  \PYG{n}{selector}\PYG{p}{:}
    \PYG{n}{matchLabels}\PYG{p}{:}
      \PYG{n}{app}\PYG{p}{:} \PYG{n}{element}
  \PYG{n}{replicas}\PYG{p}{:} \PYG{l+m+mi}{1}
  \PYG{n}{template}\PYG{p}{:}
    \PYG{n}{metadata}\PYG{p}{:}
      \PYG{n}{labels}\PYG{p}{:}
        \PYG{n}{app}\PYG{p}{:} \PYG{n}{element}
    \PYG{n}{spec}\PYG{p}{:}
      \PYG{n}{containers}\PYG{p}{:}
      \PYG{o}{\PYGZhy{}} \PYG{n}{name}\PYG{p}{:} \PYG{n}{element}
        \PYG{n}{image}\PYG{p}{:} \PYG{n}{vectorim}\PYG{o}{/}\PYG{n}{element}\PYG{o}{\PYGZhy{}}\PYG{n}{web}\PYG{p}{:}\PYG{n}{latest}
        \PYG{n}{volumeMounts}\PYG{p}{:}
        \PYG{o}{\PYGZhy{}} \PYG{n}{name}\PYG{p}{:} \PYG{n}{config}\PYG{o}{\PYGZhy{}}\PYG{n}{volume}
          \PYG{n}{mountPath}\PYG{p}{:} \PYG{o}{/}\PYG{n}{app}\PYG{o}{/}\PYG{n}{config}\PYG{o}{.}\PYG{n}{json}
          \PYG{n}{subPath}\PYG{p}{:} \PYG{n}{config}\PYG{o}{.}\PYG{n}{json}
        \PYG{n}{ports}\PYG{p}{:}
        \PYG{o}{\PYGZhy{}} \PYG{n}{containerPort}\PYG{p}{:} \PYG{l+m+mi}{80}
          \PYG{n}{name}\PYG{p}{:} \PYG{n}{element}
          \PYG{n}{protocol}\PYG{p}{:} \PYG{n}{TCP}
        \PYG{n}{readinessProbe}\PYG{p}{:}
            \PYG{n}{httpGet}\PYG{p}{:}
                \PYG{n}{path}\PYG{p}{:} \PYG{o}{/}
                \PYG{n}{port}\PYG{p}{:} \PYG{n}{element}
            \PYG{n}{initialDelaySeconds}\PYG{p}{:} \PYG{l+m+mi}{2}
            \PYG{n}{periodSeconds}\PYG{p}{:} \PYG{l+m+mi}{3}
        \PYG{n}{livenessProbe}\PYG{p}{:}
            \PYG{n}{httpGet}\PYG{p}{:}
                \PYG{n}{path}\PYG{p}{:} \PYG{o}{/}
                \PYG{n}{port}\PYG{p}{:} \PYG{n}{element}
            \PYG{n}{initialDelaySeconds}\PYG{p}{:} \PYG{l+m+mi}{10}
            \PYG{n}{periodSeconds}\PYG{p}{:} \PYG{l+m+mi}{10}
      \PYG{n}{volumes}\PYG{p}{:}
      \PYG{o}{\PYGZhy{}} \PYG{n}{name}\PYG{p}{:} \PYG{n}{config}\PYG{o}{\PYGZhy{}}\PYG{n}{volume}
        \PYG{n}{configMap}\PYG{p}{:}
          \PYG{n}{name}\PYG{p}{:} \PYG{n}{element}\PYG{o}{\PYGZhy{}}\PYG{n}{config}

\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}

\PYG{c+c1}{\PYGZsh{} Wrap it all in a Service}

\PYG{n}{apiVersion}\PYG{p}{:} \PYG{n}{v1}
\PYG{n}{kind}\PYG{p}{:} \PYG{n}{Service}
\PYG{n}{metadata}\PYG{p}{:}
  \PYG{n}{name}\PYG{p}{:} \PYG{n}{element}
  \PYG{n}{namespace}\PYG{p}{:} \PYG{n}{element}\PYG{o}{\PYGZhy{}}\PYG{n}{web}
\PYG{n}{spec}\PYG{p}{:}
  \PYG{n}{selector}\PYG{p}{:}
    \PYG{n}{app}\PYG{p}{:} \PYG{n}{element}
  \PYG{n}{ports}\PYG{p}{:}
    \PYG{o}{\PYGZhy{}} \PYG{n}{name}\PYG{p}{:} \PYG{n}{default}
      \PYG{n}{protocol}\PYG{p}{:} \PYG{n}{TCP}
      \PYG{n}{port}\PYG{p}{:} \PYG{l+m+mi}{80}
      \PYG{n}{targetPort}\PYG{p}{:} \PYG{l+m+mi}{80}

\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}

\PYG{c+c1}{\PYGZsh{} An ingress definition to expose the service via a hostname}

\PYG{n}{apiVersion}\PYG{p}{:} \PYG{n}{networking}\PYG{o}{.}\PYG{n}{k8s}\PYG{o}{.}\PYG{n}{io}\PYG{o}{/}\PYG{n}{v1}
\PYG{n}{kind}\PYG{p}{:} \PYG{n}{Ingress}
\PYG{n}{metadata}\PYG{p}{:}
  \PYG{n}{name}\PYG{p}{:} \PYG{n}{element}
  \PYG{n}{namespace}\PYG{p}{:} \PYG{n}{element}\PYG{o}{\PYGZhy{}}\PYG{n}{web}
  \PYG{n}{annotations}\PYG{p}{:}
    \PYG{n}{kubernetes}\PYG{o}{.}\PYG{n}{io}\PYG{o}{/}\PYG{n}{ingress}\PYG{o}{.}\PYG{n}{class}\PYG{p}{:} \PYG{n}{nginx}
    \PYG{n}{nginx}\PYG{o}{.}\PYG{n}{ingress}\PYG{o}{.}\PYG{n}{kubernetes}\PYG{o}{.}\PYG{n}{io}\PYG{o}{/}\PYG{n}{configuration}\PYG{o}{\PYGZhy{}}\PYG{n}{snippet}\PYG{p}{:} \PYG{o}{|}
      \PYG{n}{add\PYGZus{}header} \PYG{n}{X}\PYG{o}{\PYGZhy{}}\PYG{n}{Frame}\PYG{o}{\PYGZhy{}}\PYG{n}{Options} \PYG{n}{SAMEORIGIN}\PYG{p}{;}
      \PYG{n}{add\PYGZus{}header} \PYG{n}{X}\PYG{o}{\PYGZhy{}}\PYG{n}{Content}\PYG{o}{\PYGZhy{}}\PYG{n}{Type}\PYG{o}{\PYGZhy{}}\PYG{n}{Options} \PYG{n}{nosniff}\PYG{p}{;}
      \PYG{n}{add\PYGZus{}header} \PYG{n}{X}\PYG{o}{\PYGZhy{}}\PYG{n}{XSS}\PYG{o}{\PYGZhy{}}\PYG{n}{Protection} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{1; mode=block}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}
      \PYG{n}{add\PYGZus{}header} \PYG{n}{Content}\PYG{o}{\PYGZhy{}}\PYG{n}{Security}\PYG{o}{\PYGZhy{}}\PYG{n}{Policy} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{frame\PYGZhy{}ancestors }\PYG{l+s+s2}{\PYGZsq{}}\PYG{l+s+s2}{none}\PYG{l+s+s2}{\PYGZsq{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}
\PYG{n}{spec}\PYG{p}{:}
  \PYG{n}{rules}\PYG{p}{:}
    \PYG{o}{\PYGZhy{}} \PYG{n}{host}\PYG{p}{:} \PYG{n}{element}\PYG{o}{.}\PYG{n}{example}\PYG{o}{.}\PYG{n}{nl}
      \PYG{n}{http}\PYG{p}{:}
        \PYG{n}{paths}\PYG{p}{:}
          \PYG{o}{\PYGZhy{}} \PYG{n}{pathType}\PYG{p}{:} \PYG{n}{Prefix}
            \PYG{n}{path}\PYG{p}{:} \PYG{o}{/}
            \PYG{n}{backend}\PYG{p}{:}
              \PYG{n}{service}\PYG{p}{:}
                \PYG{n}{name}\PYG{p}{:} \PYG{n}{element}
                \PYG{n}{port}\PYG{p}{:}
                  \PYG{n}{number}\PYG{p}{:} \PYG{l+m+mi}{80}

\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}
\end{sphinxVerbatim}


\chapter{labs}
\label{\detokenize{labs:labs}}\label{\detokenize{labs::doc}}

\section{Labs features}
\label{\detokenize{labs:labs-features}}
\sphinxAtStartPar
If Labs is enabled in the \sphinxhref{config.md}{Element config}, you can enable some of these features by going
to \sphinxcode{\sphinxupquote{Settings\sphinxhyphen{}\textgreater{}Labs}}. This list is non\sphinxhyphen{}exhaustive and subject to change, chat in
\sphinxhref{https://matrix.to/\#/\#element-web:matrix.org}{\#element\sphinxhyphen{}web:matrix.org} for more information.

\sphinxAtStartPar
\sphinxstylestrong{Be warned! Labs features are not finalised, they may be fragile, they may change, they may be
dropped. Ask in the room if you are unclear about any details here.}


\chapter{Submit Abuse Report to Moderators MSC3215 support (\sphinxstyleliteralintitle{\sphinxupquote{feature\_report\_to\_moderators}})}
\label{\detokenize{labs:submit-abuse-report-to-moderators-msc3215-support-feature-report-to-moderators}}
\sphinxAtStartPar
A new version of the ‚ÄúReport‚Äù dialog that lets users send abuse reports directly to room moderators,
if the room supports it.


\chapter{Matrix Spaces MSC1772 support (\sphinxstyleliteralintitle{\sphinxupquote{feature\_spaces}})}
\label{\detokenize{labs:matrix-spaces-msc1772-support-feature-spaces}}
\sphinxAtStartPar
Enables showing, using, creating, and managing spaces. Create Spaces from the all new Space Panel (to left of Room List).

\sphinxAtStartPar
Incompatible with (will disable) \sphinxcode{\sphinxupquote{feature\_custom\_tags}}, \sphinxcode{\sphinxupquote{feature\_communities\_v2\_prototypes}} and stable Communities/Groups support.

\sphinxAtStartPar
Still in heavy development.


\chapter{Render LaTeX maths in messages (\sphinxstyleliteralintitle{\sphinxupquote{feature\_latex\_maths}})}
\label{\detokenize{labs:render-latex-maths-in-messages-feature-latex-maths}}
\sphinxAtStartPar
Enables rendering of LaTeX maths in messages using \sphinxhref{https://katex.org/}{KaTeX}. LaTeX between single dollar\sphinxhyphen{}signs is interpreted as inline maths and double dollar\sphinxhyphen{}signs as display maths (i.e. centred on its own line).


\chapter{Message pinning (\sphinxstyleliteralintitle{\sphinxupquote{feature\_pinning}})}
\label{\detokenize{labs:message-pinning-feature-pinning}}
\sphinxAtStartPar
Allows you to pin messages in the room. To pin a message, use the 3 dots to the right of the message
and select ‚ÄúPin‚Äù.


\chapter{Custom status (\sphinxstyleliteralintitle{\sphinxupquote{feature\_custom\_status}})}
\label{\detokenize{labs:custom-status-feature-custom-status}}
\sphinxAtStartPar
An experimental approach for supporting custom status messages across DMs. To set a status, click on
your avatar next to the message composer.


\chapter{Custom tags (\sphinxstyleliteralintitle{\sphinxupquote{feature\_custom\_tags}})}
\label{\detokenize{labs:custom-tags-feature-custom-tags}}
\sphinxAtStartPar
An experimental approach for dealing with custom tags. Custom tags will appear in the bottom portion
of the community filter panel.

\sphinxAtStartPar
Setting custom tags is not supported by Element.


\chapter{Render simple counters in room header (\sphinxstyleliteralintitle{\sphinxupquote{feature\_state\_counters}})}
\label{\detokenize{labs:render-simple-counters-in-room-header-feature-state-counters}}
\sphinxAtStartPar
Allows rendering of labelled counters above the message list.

\sphinxAtStartPar
Once enabled, send a custom state event to a room to set values:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
In a room, type \sphinxcode{\sphinxupquote{/devtools}} to bring up the devtools interface

\item {} 
\sphinxAtStartPar
Click ‚ÄúSend Custom Event‚Äù

\item {} 
\sphinxAtStartPar
Toggle from ‚ÄúEvent‚Äù to ‚ÄúState Event‚Äù

\item {} 
\sphinxAtStartPar
Set the event type to: \sphinxcode{\sphinxupquote{re.jki.counter}} and give it a unique key

\item {} 
\sphinxAtStartPar
Specify the content in the following format:

\end{enumerate}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{\PYGZob{}}
    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{link}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{severity}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{normal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{title}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{my counter}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{value}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+m+mi}{0}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

\sphinxAtStartPar
That‚Äôs it. Now should see your new counter under the header.


\chapter{Multiple integration managers (\sphinxstyleliteralintitle{\sphinxupquote{feature\_many\_integration\_managers}})}
\label{\detokenize{labs:multiple-integration-managers-feature-many-integration-managers}}
\sphinxAtStartPar
Exposes a way to access all the integration managers known to Element. This is an implementation of \sphinxhref{https://github.com/matrix-org/matrix-doc/pull/1957}{MSC1957}.


\chapter{New ways to ignore people (\sphinxstyleliteralintitle{\sphinxupquote{feature\_mjolnir}})}
\label{\detokenize{labs:new-ways-to-ignore-people-feature-mjolnir}}
\sphinxAtStartPar
When enabled, a new settings tab appears for users to be able to manage their ban lists.
This is a different kind of ignoring where the ignored user‚Äôs messages still get rendered,
but are hidden by default.

\sphinxAtStartPar
Ban lists are rooms within Matrix, proposed as \sphinxhref{https://github.com/matrix-org/matrix-doc/pull/2313}{MSC2313}.
\sphinxhref{https://github.com/matrix-org/mjolnir}{Mjolnir} is a set of moderation tools which support
ban lists.


\chapter{Verifications in DMs (\sphinxstyleliteralintitle{\sphinxupquote{feature\_dm\_verification}})}
\label{\detokenize{labs:verifications-in-dms-feature-dm-verification}}
\sphinxAtStartPar
An implementation of \sphinxhref{https://github.com/matrix-org/matrix-doc/pull/2241}{MSC2241}. When enabled, verification might not work with devices which don‚Äôt support MSC2241.

\sphinxAtStartPar
This also includes a new implementation of the user \& member info panel, designed to share more code between showing community members \& room members. Built on top of this new panel is also a new UX for verification from the member panel.

\sphinxAtStartPar
The setting will be removed in a future release, enabling it non\sphinxhyphen{}optionally for
all users.


\chapter{Bridge info tab (\sphinxstyleliteralintitle{\sphinxupquote{feature\_bridge\_state}})}
\label{\detokenize{labs:bridge-info-tab-feature-bridge-state}}
\sphinxAtStartPar
Adds a ‚ÄúBridge Info‚Äù tab to the Room Settings dialog, if a compatible bridge is
present in the room. The Bridge info tab pulls information from the \sphinxcode{\sphinxupquote{m.bridge}} state event (\sphinxhref{https://github.com/matrix-org/matrix-doc/pull/2346}{MSC2346}). Since the feature is based upon a MSC, most
bridges are not expected to be compatible, and users should not rely on this
tab as the single source of truth just yet.


\chapter{Presence indicator in room list (\sphinxstyleliteralintitle{\sphinxupquote{feature\_presence\_in\_room\_list}})}
\label{\detokenize{labs:presence-indicator-in-room-list-feature-presence-in-room-list}}
\sphinxAtStartPar
This adds a presence indicator in the room list next to DM rooms where the other
person is online.


\chapter{Custom themes (\sphinxstyleliteralintitle{\sphinxupquote{feature\_custom\_themes}})}
\label{\detokenize{labs:custom-themes-feature-custom-themes}}
\sphinxAtStartPar
Custom themes are possible through Element‚Äôs \sphinxhref{./theming.md}{theme support}, though
normally these themes need to be defined in the config for Element. This labs flag
adds an ability for end users to add themes themselves by using a URL to the JSON
theme definition.

\sphinxAtStartPar
For some sample themes, check out \sphinxhref{https://github.com/aaronraimist/element-themes}{aaronraimist/element\sphinxhyphen{}themes}.


\chapter{Message preview tweaks}
\label{\detokenize{labs:message-preview-tweaks}}
\sphinxAtStartPar
To enable message previews for reactions in all rooms, enable \sphinxcode{\sphinxupquote{feature\_roomlist\_preview\_reactions\_all}}.
To enable message previews for reactions in DMs, enable \sphinxcode{\sphinxupquote{feature\_roomlist\_preview\_reactions\_dms}}, ignored when it is enabled for all rooms.


\chapter{Communities v2 prototyping (\sphinxstyleliteralintitle{\sphinxupquote{feature\_communities\_v2\_prototypes}}) {[}In Development{]}}
\label{\detokenize{labs:communities-v2-prototyping-feature-communities-v2-prototypes-in-development}}
\sphinxAtStartPar
\sphinxstylestrong{This is a highly experimental implementation for parts of the communities v2 experience.} It does not
represent what communities v2 will look/feel like and can/will change without notice. Due to the early
stages this feature is in and the requirement for a compatible homeserver, we will not be accepting issues
or feedback for this functionality at this time.


\chapter{Dehydrated devices (\sphinxstyleliteralintitle{\sphinxupquote{feature\_dehydration}})}
\label{\detokenize{labs:dehydrated-devices-feature-dehydration}}
\sphinxAtStartPar
Allows users to receive encrypted messages by creating a device that is stored
encrypted on the server, as described in \sphinxhref{https://github.com/matrix-org/matrix-doc/pull/2697}{MSC2697}.


\chapter{Do not disturb (\sphinxstyleliteralintitle{\sphinxupquote{feature\_dnd}})}
\label{\detokenize{labs:do-not-disturb-feature-dnd}}
\sphinxAtStartPar
Enables UI for turning on ‚Äúdo not disturb‚Äù mode for the current device. When DND mode is engaged, popups
and notification noises are suppressed. Not perfect, but can help reduce noise.


\chapter{Hidden read receipts (\sphinxstyleliteralintitle{\sphinxupquote{feature\_hidden\_read\_receipts}})}
\label{\detokenize{labs:hidden-read-receipts-feature-hidden-read-receipts}}
\sphinxAtStartPar
Enables sending hidden read receipts as per \sphinxhref{https://github.com/matrix-org/matrix-doc/pull/2285}{MSC2285}


\chapter{memory\sphinxhyphen{}profiles\sphinxhyphen{}and\sphinxhyphen{}leaks}
\label{\detokenize{memory-profiles-and-leaks:memory-profiles-and-leaks}}\label{\detokenize{memory-profiles-and-leaks::doc}}

\chapter{Memory leaks}
\label{\detokenize{memory-profiles-and-leaks:memory-leaks}}
\sphinxAtStartPar
Element usually emits slow behaviour just before it is about to crash. Getting a
memory snapshot (below) just before that happens is ideal in figuring out what
is going wrong.

\sphinxAtStartPar
Common symptoms are clicking on a room and it feels like the tab froze and scrolling
becoming jumpy/staggered.

\sphinxAtStartPar
If you receive a white screen (electron) or the chrome crash page, it is likely
run out of memory and it is too late for a memory profile. Please do report when
this happens though so we can try and narrow down what might have gone wrong.


\chapter{Memory profiles/snapshots}
\label{\detokenize{memory-profiles-and-leaks:memory-profiles-snapshots}}
\sphinxAtStartPar
When investigating memory leaks/problems it‚Äôs usually important to compare snapshots
from different points in the Element session lifecycle. Most importantly, a snapshot
to establish the baseline or ‚Äúnormal‚Äù memory usage is useful. Taking a snapshot
roughly 30\sphinxhyphen{}60 minutes after starting Element is a good time to establish ‚Äúnormal‚Äù
memory usage for the app \sphinxhyphen{} anything after that is at risk of hiding the memory leak
and anything newer is still in the warmup stages of the app.

\sphinxAtStartPar
\sphinxstylestrong{Memory profiles can contain sensitive information.} If you are submitting a memory
profile to us for debugging purposes, please pick the appropriate Element developer and
send them over an encrypted private message. \sphinxstyleemphasis{Do not share your memory profile in
public channels or with people you do not trust.}


\section{Taking a memory profile (Firefox)}
\label{\detokenize{memory-profiles-and-leaks:taking-a-memory-profile-firefox}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Press CTRL+SHIFT+I (I as in eye).

\item {} 
\sphinxAtStartPar
Click the Memory tab.

\item {} 
\sphinxAtStartPar
Press the camera icon in the top left of the pane.

\item {} 
\sphinxAtStartPar
Wait a bit (coffee is a good option).

\item {} 
\sphinxAtStartPar
When the save button appears on the left side of the panel, click it to save the
profile locally.

\item {} 
\sphinxAtStartPar
Compress the file (gzip or regular zip) to make the file smaller.

\item {} 
\sphinxAtStartPar
Send the compressed file to whoever asked for it (if you trust them).

\end{enumerate}

\sphinxAtStartPar
While the profile is in progress, the tab might be frozen or unresponsive.


\section{Taking a memory profile (Chrome/Desktop)}
\label{\detokenize{memory-profiles-and-leaks:taking-a-memory-profile-chrome-desktop}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Press CTRL+SHIFT+I (I as in eye).

\item {} 
\sphinxAtStartPar
Click the Memory tab.

\item {} 
\sphinxAtStartPar
Select ‚ÄúHeap Snapshot‚Äù and the app.element.io VM instance (not the indexeddb one).

\item {} 
\sphinxAtStartPar
Click ‚ÄúTake Snapshot‚Äù.

\item {} 
\sphinxAtStartPar
Wait a bit (coffee is a good option).

\item {} 
\sphinxAtStartPar
When the save button appears on the left side of the panel, click it to save the
profile locally.

\item {} 
\sphinxAtStartPar
Compress the file (gzip or regular zip) to make the file smaller.

\item {} 
\sphinxAtStartPar
Send the compressed file to whoever asked for it (if you trust them).

\end{enumerate}

\sphinxAtStartPar
While the profile is in progress, the tab might be frozen or unresponsive.


\chapter{native\sphinxhyphen{}node\sphinxhyphen{}modules}
\label{\detokenize{native-node-modules:native-node-modules}}\label{\detokenize{native-node-modules::doc}}

\section{Native Node Modules}
\label{\detokenize{native-node-modules:id1}}
\sphinxAtStartPar
This documentation moved to the \sphinxtitleref{\textasciigrave{}\textasciigrave{}element\sphinxhyphen{}desktop\textasciigrave{}} \textless{}\sphinxurl{https://github.com/vector-im/element-desktop/blob/develop/docs/native-node-modules.md}\textgreater{}\textasciigrave{}\_ repository.


\chapter{pr\sphinxhyphen{}previews}
\label{\detokenize{pr-previews:pr-previews}}\label{\detokenize{pr-previews::doc}}

\section{Pull Request Previews}
\label{\detokenize{pr-previews:pull-request-previews}}
\sphinxAtStartPar
Pull requests to the React SDK layer (and in the future other layers as well)
automatically set up a preview site with a full deployment of Element with the
changes from the pull request added in so that anyone can easily test and review
them. This is especially useful for checking visual and interactive changes.

\sphinxAtStartPar
To access the preview site, scroll down to the bottom of the PR where the
various CI results are displayed:

\sphinxhref{./\_static/pr-checks.png}{\sphinxincludegraphics{{pr-checks}.png}}

\sphinxAtStartPar
The checks section could be collapsed at first, so you may need to click ‚ÄúShow
all checks‚Äù to reveal them. Look for an entry that mentions \sphinxcode{\sphinxupquote{deploy\sphinxhyphen{}preview}}. It
may be at the end of the list, so you may need scroll a bit to see it. To access
the preview site, click the ‚ÄúDetails‚Äù link in the deploy preview row.

\sphinxAtStartPar
\sphinxstylestrong{Important:} Please always use test accounts when logging into preview sites,
as they may contain unreviewed and potentially dangerous code that could damage
your account, exfiltrate encryption keys, etc.


\chapter{FAQs}
\label{\detokenize{pr-previews:faqs}}
\sphinxAtStartPar
Yes, they are created for all PRs from any author.

\sphinxAtStartPar
No, there is no expiry date, so they should remain accessible indefinitely, but
of course they obviously aren‚Äôt meant to live beyond the development workflow,
so please don‚Äôt rely on them for anything important. They may disappear at any
time without notice.


\chapter{review}
\label{\detokenize{review:review}}\label{\detokenize{review::doc}}

\section{Review Guidelines}
\label{\detokenize{review:review-guidelines}}
\sphinxAtStartPar
The following summarises review guidelines that we follow for pull requests in
Element Web and other supporting repos. These are just guidelines (not strict
rules) and may be updated over time.


\chapter{Code Review}
\label{\detokenize{review:code-review}}
\sphinxAtStartPar
When reviewing code, here are some things we look for and also things we avoid:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Correctness

\item {} 
\sphinxAtStartPar
Performance

\item {} 
\sphinxAtStartPar
Accessibility

\item {} 
\sphinxAtStartPar
Security

\item {} 
\sphinxAtStartPar
Quality via automated and manual testing

\item {} 
\sphinxAtStartPar
Comments and documentation where needed

\item {} 
\sphinxAtStartPar
Sharing knowledge of different areas among the team

\item {} 
\sphinxAtStartPar
Ensuring it‚Äôs something we‚Äôre comfortable maintaining for the long term

\item {} 
\sphinxAtStartPar
Progress indicators and local echo where appropriate with network activity

\end{itemize}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Style nits that are already handled by the linter

\item {} 
\sphinxAtStartPar
Dramatically increasing scope

\end{itemize}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Use empathetic language
\begin{itemize}
\item {} 
\sphinxAtStartPar
See also \sphinxhref{https://kickstarter.engineering/a-guide-to-mindful-communication-in-code-reviews-48aab5282e5e}{Mindful Communication in Code
Reviews}
and \sphinxhref{https://mtlynch.io/human-code-reviews-1/}{How to Do Code Reviews Like a Human}

\end{itemize}

\item {} 
\sphinxAtStartPar
Authors should prefer smaller commits for easier reviewing and bisection

\item {} 
\sphinxAtStartPar
Reviewers should be explicit about required versus optional changes
\begin{itemize}
\item {} 
\sphinxAtStartPar
Reviews are conversations and the PR author should feel comfortable
discussing and pushing back on changes before making them

\end{itemize}

\item {} 
\sphinxAtStartPar
Reviewers are encouraged to ask for tests where they believe it is reasonable

\item {} 
\sphinxAtStartPar
Core team should lead by example through their tone and language

\item {} 
\sphinxAtStartPar
Take the time to thank and point out good code changes

\item {} 
\sphinxAtStartPar
Using softer language like ‚Äúplease‚Äù and ‚Äúwhat do you think?‚Äù goes a long way
towards making others feel like colleagues working towards a common goal

\end{itemize}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Authors should request review from the element\sphinxhyphen{}web team by default (if someone on
the team is clearly the expert in an area, a direct review request to them may
be more appropriate)

\item {} 
\sphinxAtStartPar
Reviewers should remove the team review request and request review from
themselves when starting a review to avoid double review

\item {} 
\sphinxAtStartPar
If there are multiple related PRs authors should reference each of the PRs in
the others before requesting review. Reviewers might start reviewing from
different places and could miss other required PRs.

\item {} 
\sphinxAtStartPar
Avoid force pushing to a PR after the first round of review

\item {} 
\sphinxAtStartPar
Use the GitHub default of merge commits when landing (avoid alternate options
like squash or rebase)

\item {} 
\sphinxAtStartPar
PR author merges after review (assuming they have write access)

\item {} 
\sphinxAtStartPar
Assign issues only when in progress to indicate to others what can be picked
up

\end{itemize}


\chapter{Code Quality}
\label{\detokenize{review:code-quality}}
\sphinxAtStartPar
In the past, we have occasionally written different kinds of tests for
Element and the SDKs, but it hasn‚Äôt been a consistent focus. Going forward, we‚Äôd
like to change that.
\begin{itemize}
\item {} 
\sphinxAtStartPar
For new features, code reviewers will expect some form of automated testing to
be included by default

\item {} 
\sphinxAtStartPar
For bug fixes, regression tests are of course great to have, but we don‚Äôt want
to block fixes on this, so we won‚Äôt require them at this time

\end{itemize}

\sphinxAtStartPar
The above policy is not a strict rule, but instead it‚Äôs meant to be a
conversation between the author and reviewer. As an author, try to think about
writing a test when making your next change. As a reviewer, try to think about
how you might test the area of code you are reviewing. If the reviewer agrees
it would be quite difficult to test some new feature, then it‚Äôs okay for them to
accept the change without tests for now, but we‚Äôd eventually like to be more
strict about this further down the road.

\sphinxAtStartPar
If you do spot areas that are quite hard to test today, please let us know in
\sphinxhref{https://matrix.to/\#/\#element-dev:matrix.org}{\#element\sphinxhyphen{}dev:matrix.org}. We can
work on improving the app architecture and testing helpers so that future tests
are easier for everyone to write, but we won‚Äôt know which parts are difficult
unless people shout when stumbling through them.

\sphinxAtStartPar
We recognise that this testing policy will slow things down a bit, but overall
it should encourage better long\sphinxhyphen{}term health of the app and give everyone more
confidence when making changes as coverage increases over time.

\sphinxAtStartPar
For changes guarded by a feature flag, we currently lean towards prioritising
our ability to evolve quickly using such flags and thus we will not currently
require tests to appear at the same time as the initial landing of features
guarded by flags, as long as (for new flagged features going forward) the
feature author understands that they are effectively deferring part of their
work (adding tests) until later and tests are expected to appear before the
feature can be enabled by default.


\chapter{Design and Product Review}
\label{\detokenize{review:design-and-product-review}}
\sphinxAtStartPar
We want to ensure that all changes to Element fit with our design and product
vision. We often request review from those teams so they can provide their
perspective.

\sphinxAtStartPar
In more detail, our usual process for changes that affect the UI or alter user
functionality is:
\begin{itemize}
\item {} 
\sphinxAtStartPar
For changes that will go live when merged, always flag Design and Product
teams as appropriate

\item {} 
\sphinxAtStartPar
For changes guarded by a feature flag, Design and Product review is not
required (though may still be useful) since we can continue tweaking

\end{itemize}

\sphinxAtStartPar
As it can be difficult to review design work from looking at just the changed
files in a PR, a \sphinxhref{./pr-previews.md}{preview site} that includes your changes
will be added automatically so that anyone who‚Äôs interested can try them out
easily.

\sphinxAtStartPar
Before starting work on a feature, it‚Äôs best to ensure your plan aligns well
with our vision for Element. Please chat with the team in
\sphinxhref{https://matrix.to/\#/\#element-dev:matrix.org}{\#element\sphinxhyphen{}dev:matrix.org} before
you start so we can ensure it‚Äôs something we‚Äôd be willing to merge.


\chapter{iiitemskinning thoughts}
\label{\detokenize{skinning thoughts:iiitemskinning-thoughts}}\label{\detokenize{skinning thoughts::doc}}
\sphinxAtStartPar
== Skinning refactor ==

\sphinxAtStartPar
matrix\sphinxhyphen{}react\sphinxhyphen{}sdk
\begin{itemize}
\item {} 
\sphinxAtStartPar
base images

\item {} 
\sphinxAtStartPar
base CSS

\item {} 
\sphinxAtStartPar
all the components needed to build a workable app (including the top layer)

\end{itemize}

\sphinxAtStartPar
element\sphinxhyphen{}web: the Element skin
\begin{itemize}
\item {} 
\sphinxAtStartPar
Element\sphinxhyphen{}specific classes (e.g. login header/footer)

\item {} 
\sphinxAtStartPar
Element\sphinxhyphen{}specific themes
\begin{itemize}
\item {} 
\sphinxAtStartPar
light

\item {} 
\sphinxAtStartPar
dark

\end{itemize}

\end{itemize}

\sphinxAtStartPar
i.e. the only things which should go into element\sphinxhyphen{}web are bits which apply vector\sphinxhyphen{}specific skinning
specifically ‚ÄúStuff that any other brand would not want to use. (e.g. Element logos, links, T\&Cs)‚Äù
\begin{itemize}
\item {} 
\sphinxAtStartPar
Questions:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Electron app?  (should probably be a separate repo in its own right?  but might as well go here for now)

\item {} 
\sphinxAtStartPar
index.html \& index.js?  (should be in matrix\sphinxhyphen{}react\sphinxhyphen{}sdk, given the SDK is useless without them?)

\end{itemize}

\end{itemize}

\sphinxAtStartPar
ideally matrix\sphinxhyphen{}react\sphinxhyphen{}sdk itself should ship with a default skin which actually works built in.

\sphinxAtStartPar
status skin (can go in the same app for now)
\begin{itemize}
\item {} 
\sphinxAtStartPar
has status theme
\begin{itemize}
\item {} 
\sphinxAtStartPar
which inherits from Element light theme

\item {} 
\sphinxAtStartPar
how do we share graphics between skins?
\begin{itemize}
\item {} 
\sphinxAtStartPar
shove them into react\sphinxhyphen{}sdk, or‚Ä¶

\item {} 
\sphinxAtStartPar
guess we do ../../vector/img

\item {} 
\sphinxAtStartPar
this means keeping the skin name in the images (unless /img is a shortcut to the right skin‚Äôs images)

\end{itemize}

\end{itemize}

\end{itemize}

\sphinxAtStartPar
out of scope:
\begin{itemize}
\item {} 
\sphinxAtStartPar
making the components more independent, so they can be used in isolation.

\item {} 
\sphinxAtStartPar
that said, the bits which should probably be used by being embeded into a different app:
\begin{itemize}
\item {} 
\sphinxAtStartPar
login/reg

\item {} 
\sphinxAtStartPar
RoomView + RoomSettings

\item {} 
\sphinxAtStartPar
MessageComposer

\item {} 
\sphinxAtStartPar
RoomList

\item {} 
\sphinxAtStartPar
MemberList

\item {} 
\sphinxAtStartPar
MemberInfo

\item {} 
\sphinxAtStartPar
Voip UI

\item {} 
\sphinxAtStartPar
UserSettings

\end{itemize}

\item {} 
\sphinxAtStartPar
sharing different js\sphinxhyphen{}sdks between the different isolated modules

\end{itemize}

\sphinxAtStartPar
other changes:
\begin{itemize}
\item {} 
\sphinxAtStartPar
how do we handle i18n?
\begin{itemize}
\item {} 
\sphinxAtStartPar
each skin should really be its own i18n project.  As long as all the commonality stuff is in matrix\sphinxhyphen{}react\sphinxhyphen{}sdk this shouldn‚Äôt be too bad.

\end{itemize}

\item {} 
\sphinxAtStartPar
ability to associate components with a given skin
\begin{itemize}
\item {} 
\sphinxAtStartPar
skins/vector/src \textless{}\textendash{} components

\item {} 
\sphinxAtStartPar
skins/vector/css

\item {} 
\sphinxAtStartPar
skins/vector/img

\item {} 
\sphinxAtStartPar
skins/vector/fonts

\end{itemize}

\item {} 
\sphinxAtStartPar
gather together themes (per skin) into a single place too
\begin{itemize}
\item {} 
\sphinxAtStartPar
skins/vector/themes/foo/css

\item {} 
\sphinxAtStartPar
skins/vector/themes/foo/img

\item {} 
\sphinxAtStartPar
skins/vector/themes/foo/fonts

\end{itemize}

\item {} 
\sphinxAtStartPar
ideally element\sphinxhyphen{}web would contain almost nothing but skins/vector directory.

\item {} 
\sphinxAtStartPar
ability to entirely replace CSS rather than override it for a given theme
\begin{itemize}
\item {} 
\sphinxAtStartPar
e.g. if we replace \sphinxcode{\sphinxupquote{Login.js}} with \sphinxcode{\sphinxupquote{StatusLogin.js}}, then we should similarly be able to replace \sphinxcode{\sphinxupquote{\_Login.scss}} with \sphinxcode{\sphinxupquote{\_StatusLogin.scss}}.

\end{itemize}

\end{itemize}

\sphinxAtStartPar
random thoughts;
\begin{itemize}
\item {} 
\sphinxAtStartPar
should we be able to change the entire skin at runtime (more like wordpress) \sphinxhyphen{} to the extent of replacing entire components?
\begin{itemize}
\item {} 
\sphinxAtStartPar
might pose security issues if a theme can be swapped out to replace MatrixChat or other fundamental functionality at runtime

\end{itemize}

\item {} 
\sphinxAtStartPar
if so, perhaps skins \& themes should converge‚Ä¶

\end{itemize}


\bigskip\hrule\bigskip


\sphinxAtStartPar
Immediate plan for Status:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Implement it as a theme for the Element skin

\item {} 
\sphinxAtStartPar
Ideally move skins to a sensible level (possibly even including src?)

\end{itemize}


\chapter{theming}
\label{\detokenize{theming:theming}}\label{\detokenize{theming::doc}}

\section{Theming Element}
\label{\detokenize{theming:theming-element}}
\sphinxAtStartPar
Themes are a very basic way of providing simple alternative look \& feels to the
Element app via CSS \& custom imagery.

\sphinxAtStartPar
They are \sphinxstyleemphasis{NOT} co be confused with ‚Äòskins‚Äô, which describe apps which sit on top
of matrix\sphinxhyphen{}react\sphinxhyphen{}sdk \sphinxhyphen{} e.g. in theory Element itself is a react\sphinxhyphen{}sdk skin.
As of Jan 2017, skins are not fully supported; Element is the only available skin.

\sphinxAtStartPar
To define a theme for Element:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Pick a name, e.g. \sphinxcode{\sphinxupquote{teal}}. at time of writing we have \sphinxcode{\sphinxupquote{light}} and \sphinxcode{\sphinxupquote{dark}}.

\item {} 
\sphinxAtStartPar
Fork \sphinxcode{\sphinxupquote{src/skins/vector/css/themes/dark.scss}} to be \sphinxcode{\sphinxupquote{teal.scss}}

\item {} 
\sphinxAtStartPar
Fork \sphinxcode{\sphinxupquote{src/skins/vector/css/themes/\_base.scss}} to be \sphinxcode{\sphinxupquote{\_teal.scss}}

\item {} 
\sphinxAtStartPar
Override variables in \sphinxcode{\sphinxupquote{\_teal.scss}} as desired. You may wish to delete ones
which don‚Äôt differ from \sphinxcode{\sphinxupquote{\_base.scss}}, to make it clear which are being
overridden. If every single colour is being changed (as per \sphinxcode{\sphinxupquote{\_dark.scss}})
then you might as well keep them all.

\item {} 
\sphinxAtStartPar
Add the theme to the list of entrypoints in webpack.config.js

\item {} 
\sphinxAtStartPar
Add the theme to the list of themes in matrix\sphinxhyphen{}react\sphinxhyphen{}sdk‚Äôs UserSettings.js

\item {} 
\sphinxAtStartPar
Sit back and admire your handywork.

\end{enumerate}

\sphinxAtStartPar
In future, the assets for a theme will probably be gathered together into a
single directory tree.


\section{Custom Themes}
\label{\detokenize{theming:custom-themes}}
\sphinxAtStartPar
Themes derived from the built in themes may also be defined in settings.

\sphinxAtStartPar
To avoid name collisions, the internal name of a theme is
\sphinxcode{\sphinxupquote{custom\sphinxhyphen{}\$\{theme.name\}}}. So if you want to set the custom theme below as the
default theme, you would use \sphinxcode{\sphinxupquote{default\_theme: "custom\sphinxhyphen{}Electric Blue"}}.

\sphinxAtStartPar
eg. in config.json:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{settingDefaults}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{custom\PYGZus{}themes}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{[}
            \PYG{p}{\PYGZob{}}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Electric Blue}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{is\PYGZus{}dark}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{false}\PYG{p}{,}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{fonts}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{faces}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{[}
                        \PYG{p}{\PYGZob{}}
                            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{font\PYGZhy{}family}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Inter}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{src}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{url}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/fonts/Inter.ttf}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{format}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ttf}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{]}
                        \PYG{p}{\PYGZcb{}}
                    \PYG{p}{]}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{general}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Inter, sans}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{monospace}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsq{}}\PYG{l+s+s2}{Courier New}\PYG{l+s+s2}{\PYGZsq{}}\PYG{l+s+s2}{\PYGZdq{}}
                \PYG{p}{\PYGZcb{}}\PYG{p}{,}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{colors}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{accent\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}3596fc}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{primary\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}368bd6}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{warning\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}ff4b55}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{sidebar\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}27303a}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{roomlist\PYGZhy{}background\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}f3f8fd}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{roomlist\PYGZhy{}text\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}2e2f32}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{roomlist\PYGZhy{}text\PYGZhy{}secondary\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}61708b}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{roomlist\PYGZhy{}highlights\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}ffffff}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{roomlist\PYGZhy{}separator\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}e3e8f0}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{timeline\PYGZhy{}background\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}ffffff}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{timeline\PYGZhy{}text\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}2e2f32}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{timeline\PYGZhy{}text\PYGZhy{}secondary\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}61708b}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{timeline\PYGZhy{}highlights\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}f3f8fd}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{username\PYGZhy{}colors}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}ff0000}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{]}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{avatar\PYGZhy{}background\PYGZhy{}colors}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}cc0000}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{]}
                \PYG{p}{\PYGZcb{}}
            \PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{p}{\PYGZob{}}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Deep Purple}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{is\PYGZus{}dark}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{true}\PYG{p}{,}
                \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{colors}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{accent\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}6503b3}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{primary\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}368bd6}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{warning\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}b30356}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{sidebar\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}15171B}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{roomlist\PYGZhy{}background\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}22262E}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{roomlist\PYGZhy{}text\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}A1B2D1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{roomlist\PYGZhy{}text\PYGZhy{}secondary\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}EDF3FF}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{roomlist\PYGZhy{}highlights\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}343A46}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{roomlist\PYGZhy{}separator\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}a1b2d1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{timeline\PYGZhy{}background\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}181b21}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{timeline\PYGZhy{}text\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}EDF3FF}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{timeline\PYGZhy{}text\PYGZhy{}secondary\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}A1B2D1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
                    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{timeline\PYGZhy{}highlights\PYGZhy{}color}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZsh{}22262E}\PYG{l+s+s2}{\PYGZdq{}}
                \PYG{p}{\PYGZcb{}}
            \PYG{p}{\PYGZcb{}}
        \PYG{p}{]}
    \PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{username\sphinxhyphen{}colors}} is expected to contain 8 colors. \sphinxcode{\sphinxupquote{avatar\sphinxhyphen{}background\sphinxhyphen{}colors}} is expected to contain 3 colors. Both values are optional and have fallbacks from the built\sphinxhyphen{}in theme.

\sphinxAtStartPar
These are exposed as \sphinxcode{\sphinxupquote{\sphinxhyphen{}\sphinxhyphen{}username\sphinxhyphen{}colors\_0}}, ‚Ä¶ and \sphinxcode{\sphinxupquote{\sphinxhyphen{}\sphinxhyphen{}avatar\sphinxhyphen{}background\sphinxhyphen{}colors\_0}}, ‚Ä¶ respectively in CSS.

\sphinxAtStartPar
All properties in \sphinxcode{\sphinxupquote{fonts}} are optional, and will default to the standard Riot fonts.


\chapter{translating\sphinxhyphen{}dev}
\label{\detokenize{translating-dev:translating-dev}}\label{\detokenize{translating-dev::doc}}

\section{How to translate Element (Dev Guide)}
\label{\detokenize{translating-dev:how-to-translate-element-dev-guide}}

\chapter{Requirements}
\label{\detokenize{translating-dev:requirements}}\begin{itemize}
\item {} 
\sphinxAtStartPar
A working \sphinxhref{../../\#setting-up-a-dev-environment}{Development Setup}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Including up\sphinxhyphen{}to\sphinxhyphen{}date versions of matrix\sphinxhyphen{}react\sphinxhyphen{}sdk and matrix\sphinxhyphen{}js\sphinxhyphen{}sdk

\end{itemize}

\item {} 
\sphinxAtStartPar
Latest LTS version of Node.js installed

\item {} 
\sphinxAtStartPar
Be able to understand English

\item {} 
\sphinxAtStartPar
Be able to understand the language you want to translate Element into

\end{itemize}


\chapter{Translating strings vs. marking strings for translation}
\label{\detokenize{translating-dev:translating-strings-vs-marking-strings-for-translation}}
\sphinxAtStartPar
Translating strings are done with the \sphinxcode{\sphinxupquote{\_t()}} function found in matrix\sphinxhyphen{}react\sphinxhyphen{}sdk/lib/languageHandler.js. It is recommended to call this function wherever you introduce a string constant which should be translated. However, translating can not be performed until after the translation system has been initialized. Thus, sometimes translation must be performed at a different location in the source code than where the string is introduced. This breaks some tooling and makes it difficult to find translatable strings. Therefore, there is the alternative \sphinxcode{\sphinxupquote{\_td()}} function which is used to mark strings for translation, without actually performing the translation (which must still be performed separately, and after the translation system has been initialized).

\sphinxAtStartPar
Basically, whenever a translatable string is introduced, you should call either \sphinxcode{\sphinxupquote{\_t()}} immediately OR \sphinxcode{\sphinxupquote{\_td()}} and later \sphinxcode{\sphinxupquote{\_t()}}.

\sphinxAtStartPar
Example:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{/}\PYG{o}{/} \PYG{n}{Module}\PYG{o}{\PYGZhy{}}\PYG{n}{level} \PYG{n}{constant}
\PYG{n}{const} \PYG{n}{COLORS} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsh{}f8481c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{\PYGZus{}td}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{reddish orange}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,} \PYG{o}{/}\PYG{o}{/} \PYG{n}{Can}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t call \PYGZus{}t() here yet}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsh{}fc2647}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{\PYGZus{}td}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pinky red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{o}{/}\PYG{o}{/} \PYG{n}{Use} \PYG{n}{\PYGZus{}td}\PYG{p}{(}\PYG{p}{)} \PYG{n}{instead} \PYG{n}{so} \PYG{n}{the} \PYG{n}{text} \PYG{o+ow}{is} \PYG{n}{picked} \PYG{n}{up} \PYG{k}{for} \PYG{n}{translation} \PYG{n}{anyway}
\PYG{p}{\PYGZcb{}}

\PYG{o}{/}\PYG{o}{/} \PYG{n}{Function} \PYG{n}{that} \PYG{o+ow}{is} \PYG{n}{called} \PYG{n}{some} \PYG{n}{time} \PYG{n}{after} \PYG{n}{i18n} \PYG{n}{has} \PYG{n}{been} \PYG{n}{loaded}
\PYG{n}{function} \PYG{n}{getColorName}\PYG{p}{(}\PYG{n+nb}{hex}\PYG{p}{)} \PYG{p}{\PYGZob{}}
    \PYG{k}{return} \PYG{n}{\PYGZus{}t}\PYG{p}{(}\PYG{n}{COLORS}\PYG{p}{[}\PYG{n+nb}{hex}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;} \PYG{o}{/}\PYG{o}{/} \PYG{n}{Perform} \PYG{n}{actual} \PYG{n}{translation} \PYG{n}{here}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\chapter{Adding new strings}
\label{\detokenize{translating-dev:adding-new-strings}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Check if the import \sphinxcode{\sphinxupquote{import \{ \_t \} from \textquotesingle{}matrix\sphinxhyphen{}react\sphinxhyphen{}sdk/lib/languageHandler\textquotesingle{};}} is present. If not add it to the other import statements. Also import \sphinxcode{\sphinxupquote{\_td}} if needed.

\item {} 
\sphinxAtStartPar
Add \sphinxcode{\sphinxupquote{\_t()\textbackslash{} \textasciigrave{}}} to your string. (Don‚Äôt forget curly braces when you assign an expression to JSX attributes in the render method). If the string is introduced at a point before the translation system has not yet been initialized, use\textasciigrave{}\textasciigrave{}\_td()\textasciigrave{} instead, and call \sphinxtitleref{\_t()} at the appropriate time.

\item {} 
\sphinxAtStartPar
Run \sphinxcode{\sphinxupquote{yarn i18n}} to update \sphinxcode{\sphinxupquote{src/i18n/strings/en\_EN.json}}

\item {} 
\sphinxAtStartPar
If you added a string with a plural, you can add other English plural variants to \sphinxcode{\sphinxupquote{src/i18n/strings/en\_EN.json}} (remeber to edit the one in the same project as the source file containing your new translation).

\end{enumerate}


\chapter{Editing existing strings}
\label{\detokenize{translating-dev:editing-existing-strings}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Edit every occurrence of the string inside \sphinxcode{\sphinxupquote{\_t()}} and \sphinxcode{\sphinxupquote{\_td()}} in the JSX files.

\item {} 
\sphinxAtStartPar
Run \sphinxcode{\sphinxupquote{yarn i18n}} to update \sphinxcode{\sphinxupquote{src/i18n/strings/en\_EN.json}}. (Be sure to run this in the same project as the JSX files you just edited.)

\item {} 
\sphinxAtStartPar
Run \sphinxcode{\sphinxupquote{yarn prunei18n}} to remove the old string from \sphinxcode{\sphinxupquote{src/i18n/strings/*.json}}.

\end{enumerate}


\chapter{Adding variables inside a string.}
\label{\detokenize{translating-dev:adding-variables-inside-a-string}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Extend your \sphinxcode{\sphinxupquote{\_t()\textbackslash{} \textasciigrave{}\textasciigrave{}call. Instead of}}\_t(STRING)\sphinxcode{\sphinxupquote{use}}\_t(STRING, \{\})\textasciigrave{}\textasciigrave{}

\item {} 
\sphinxAtStartPar
Decide how to name it. Please think about if the person who has to translate it can understand what it does. E.g. using the name ‚Äòrecipient‚Äô is bad, because a translator does not know if it is the name of a person, an email address, a user ID, etc. Rather use e.g. recipientEmailAddress.

\item {} 
\sphinxAtStartPar
Add it to the array in \sphinxcode{\sphinxupquote{\_t\textbackslash{} \textasciigrave{}\textasciigrave{}for example}}\_t(STRING, \{variable: this.variable\})\textasciigrave{}\textasciigrave{}

\item {} 
\sphinxAtStartPar
Add the variable inside the string. The syntax for variables is \sphinxcode{\sphinxupquote{\%(variable)s}}. Please note the \sphinxstyleemphasis{s} at the end. The name of the variable has to match the previous used name.

\end{enumerate}
\begin{itemize}
\item {} 
\sphinxAtStartPar
You can use the special \sphinxcode{\sphinxupquote{count}} variable to choose between multiple versions of the same string, in order to get the correct pluralization. E.g. \sphinxcode{\sphinxupquote{\_t(\textquotesingle{}You have \%(count)s new messages\textquotesingle{}, \{ count: 2 \})\textbackslash{} \textasciigrave{}\textasciigrave{}would show \textquotesingle{}You have 2 new messages\textquotesingle{}, while}}\_t(‚ÄòYou have \%(count)s new messages‚Äô, \{ count: 1 \})\sphinxcode{\sphinxupquote{would show \textquotesingle{}You have one new message\textquotesingle{} (assuming a singular version of the string has been added to the translation file. See above). Passing in}}count\textasciigrave{}\textasciigrave{} is much prefered over having an if\sphinxhyphen{}statement choose the correct string to use, because some languages have much more complicated plural rules than english (e.g. they might need a completely different form if there are three things rather than two).

\item {} 
\sphinxAtStartPar
If you want to translate text that includes e.g. hyperlinks or other HTML you have to also use tag substitution, e.g. \sphinxcode{\sphinxupquote{\_t(\textquotesingle{}\textbackslash{} :raw\sphinxhyphen{}html\sphinxhyphen{}m2r:\textasciigrave{}\textless{}a\textgreater{}Click here!\textless{}/a\textgreater{}\textasciigrave{}\textbackslash{} \textquotesingle{}, \{\}, \{ \textquotesingle{}a\textquotesingle{}: (sub) =\textgreater{} :raw\sphinxhyphen{}html\sphinxhyphen{}m2r:\textasciigrave{}\textless{}a\textgreater{}\{sub\}\textless{}/a\textgreater{}\textasciigrave{} \})}}. If you don‚Äôt do the tag substitution you will end up showing literally ‚Äò‚Äò rather than making a hyperlink.

\item {} 
\sphinxAtStartPar
You can also use React components with normal variable substitution if you want to insert HTML markup, e.g. \sphinxcode{\sphinxupquote{\_t(\textquotesingle{}Your email address is \%(emailAddress)s\textquotesingle{}, \{ emailAddress: :raw\sphinxhyphen{}html\sphinxhyphen{}m2r:\textasciigrave{}\textless{}i\textgreater{}\{userEmailAddress\}\textless{}/i\textgreater{}\textasciigrave{} \})}}.

\end{itemize}


\chapter{Things to know/Style Guides}
\label{\detokenize{translating-dev:things-to-know-style-guides}}\begin{itemize}
\item {} 
\sphinxAtStartPar
Do not use \sphinxcode{\sphinxupquote{\_t()}} inside \sphinxcode{\sphinxupquote{getDefaultProps}}: the translations aren‚Äôt loaded when \sphinxcode{\sphinxupquote{getDefaultProps}} is called, leading to missing translations. Use \sphinxcode{\sphinxupquote{\_td()}} to indicate that \sphinxcode{\sphinxupquote{\_t()}} will be called on the string later.

\item {} 
\sphinxAtStartPar
If using translated strings as constants, translated strings can‚Äôt be in constants loaded at class\sphinxhyphen{}load time since the translations won‚Äôt be loaded. Mark the strings using \sphinxcode{\sphinxupquote{\_td()}} instead and perform the actual translation later.

\item {} 
\sphinxAtStartPar
If a string is presented in the UI with punctuation like a full stop, include this in the translation strings, since punctuation varies between languages too.

\item {} 
\sphinxAtStartPar
Avoid ‚Äútranslation in parts‚Äù, i.e. concatenating translated strings or using translated strings in variable substitutions. Context is important for translations, and translating partial strings this way is simply not always possible.

\item {} 
\sphinxAtStartPar
Concatenating strings often also introduces an implicit assumption about word order (e.g. that the subject of the sentence comes first), which is incorrect for many languages.

\item {} 
\sphinxAtStartPar
Translation ‚Äòsmell test‚Äô: If you have a string that does not begin with a capital letter (is not the start of a sentence) or it ends with e.g. ‚Äò:‚Äô or a preposition (e.g. ‚Äòto‚Äô) you should recheck that you are not trying to translate a partial sentence.

\item {} 
\sphinxAtStartPar
If you have multiple strings, that are almost identical, except some part (e.g. a word or two) it is still better to translate the full sentence multiple times. It may seem like inefficient repetion, but unlike programming where you try to minimize repetition, translation is much faster if you have many, full, clear, sentences to work with, rather than fewer, but incomplete sentence fragments.

\end{itemize}


\chapter{translating}
\label{\detokenize{translating:translating}}\label{\detokenize{translating::doc}}

\section{How to translate Element}
\label{\detokenize{translating:how-to-translate-element}}

\chapter{Requirements}
\label{\detokenize{translating:requirements}}\begin{itemize}
\item {} 
\sphinxAtStartPar
Web Browser

\item {} 
\sphinxAtStartPar
Be able to understand English

\item {} 
\sphinxAtStartPar
Be able to understand the language you want to translate Element into

\end{itemize}


\chapter{Step 0: Join \#element\sphinxhyphen{}translations:matrix.org}
\label{\detokenize{translating:step-0-join-element-translations-matrix-org}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Come and join \sphinxurl{https://matrix.to}/\#/\#element\sphinxhyphen{}translations:matrix.org for general discussion

\item {} 
\sphinxAtStartPar
Join \sphinxurl{https://matrix.to}/\#/\#element\sphinxhyphen{}translators:matrix.org for language\sphinxhyphen{}specific rooms

\item {} 
\sphinxAtStartPar
Read scrollback and/or ask if anyone else is working on your language, and co\sphinxhyphen{}ordinate if needed.  In general little\sphinxhyphen{}or\sphinxhyphen{}no coordination is needed though :)

\end{enumerate}


\chapter{Step 1: Preparing your Weblate Profile}
\label{\detokenize{translating:step-1-preparing-your-weblate-profile}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Head to \sphinxurl{https://translate.element.io} and register either via Github or email

\item {} 
\sphinxAtStartPar
After registering check if you got an email to verify your account and click the link (if there is none head to step 1.4)

\item {} 
\sphinxAtStartPar
Log into weblate

\item {} 
\sphinxAtStartPar
Head to \sphinxurl{https://translate.element.io/accounts/profile/} and select the languages you know and maybe another language you know too.

\item {} 
\sphinxAtStartPar
Head to \sphinxurl{https://translate.element.io/accounts/profile/\#subscriptions} and select Element Web as Project

\end{enumerate}


\chapter{How to check if your language already is being translated}
\label{\detokenize{translating:how-to-check-if-your-language-already-is-being-translated}}
\sphinxAtStartPar
Go to \sphinxurl{https://translate.element.io/projects/element-web/} and visit the 2 sub\sphinxhyphen{}projects.
If your language is listed go to Step 2a and if not go to Step 2b


\chapter{Step 2a: Helping on existing languages.}
\label{\detokenize{translating:step-2a-helping-on-existing-languages}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Head to one of the projects listed \sphinxurl{https://translate.element.io/projects/element-web/}

\item {} 
\sphinxAtStartPar
Click on the \sphinxcode{\sphinxupquote{translate}} button on the right side of your language

\item {} 
\sphinxAtStartPar
Fill in the translations in the writeable field. You will see the original English string and the string of your second language above.

\end{enumerate}

\sphinxAtStartPar
Head to the explanations under Steb 2b


\chapter{Step 2b: Adding a new language}
\label{\detokenize{translating:step-2b-adding-a-new-language}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Go to one of the projects listed \sphinxurl{https://translate.element.io/projects/element-web/}

\item {} 
\sphinxAtStartPar
Click the \sphinxcode{\sphinxupquote{Start new translation}} button at the bottom

\item {} 
\sphinxAtStartPar
Select a language

\item {} 
\sphinxAtStartPar
Start translating like in 2a.3

\item {} 
\sphinxAtStartPar
Repeat these steps for the other projects which are listed at the link of step 2b.1

\end{enumerate}

\sphinxAtStartPar
The green button let you save our translations directly. Please only use it if you are 100\% sure about that translation. If you do not know a translation please DO NOT click that button. Use the arrows above the translations field and click to the right.

\sphinxAtStartPar
The yellow button has to be used if you are unsure about the translation but you have a rough idea. It adds a new suggestion to the string which can than be reviewed by others.

\sphinxAtStartPar
These things are variables that are expanded when displayed by Element. They can be room names, usernames or similar. If you find one, you can move to the right place for your language, but not delete it as the variable will be missing if you do.

\sphinxAtStartPar
A special case is \sphinxcode{\sphinxupquote{\%(urlStart)s}} and \sphinxcode{\sphinxupquote{\%(urlEnd)s}} which are used to mark the beginning of a hyperlink (i.e. \sphinxcode{\sphinxupquote{\textless{}a href="/somewhere"\textgreater{}}} and \sphinxcode{\sphinxupquote{\textless{}/a\textgreater{}}}.  You must keep these markers surrounding the equivalent string in your language that needs to be hyperlinked.

\sphinxAtStartPar
You can use inside the translation field ‚ÄúReview needed‚Äù checkbox. It will be shown as Strings that need to be reviewed.

\sphinxAtStartPar
The official Weblate doc provides some more in\sphinxhyphen{}deepth explanation on how to do translations and talks about do and don‚Äôts. You can find it at: \sphinxurl{https://docs.weblate.org/en/latest/user/translating.html}


\chapter{\sphinxstylestrong{Document Author(s):}}
\label{\detokenize{index:document-author-s}}

\bigskip\hrule\bigskip



\chapter{\sphinxstylestrong{DATRO Consortium}}
\label{\detokenize{index:datro-consortium}}


\renewcommand{\indexname}{Index}
\printindex
\end{document}