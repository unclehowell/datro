<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width">
    <script>
    var gaProperty = 'UA-2577926-1';
    // Disable tracking if the opt-out cookie exists.
    var disableStr = 'ga-disable-' + gaProperty;
    if (document.cookie.indexOf(disableStr + '=true') > -1) {
      window[disableStr] = true;
    }
    function gaOptout() {
      document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
      window[disableStr] = true;
    }
    function gaOptoutRevoke() {
      document.cookie = disableStr + '=false; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
      window[disableStr] = false;
    }
    </script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2577926-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-2577926-1', { 'anonymize_ip': true });
    </script>
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
    <script src="https://unpkg.com/lz-string@1.4.4/libs/lz-string.min.js"></script>
    <script>
    window.addEventListener("load", function() {
      window.cookieconsent.initialise({
        'palette': {
          'popup': {
            'background': '#eaf7f7',
            'text': '#5c7291'
          },
          'button': {
            'background': '#56cbdb',
            'text': '#ffffff'
          }
        },
        'theme': 'edgeless',
        'type': 'opt-out',
        'onInitialise': function (status) {
          if (!this.hasConsented()) {
            gaOptout()
          }
        },
        'onStatusChange': function(status, chosenBefore) {
          if (!this.hasConsented()) {
            gaOptout()
          }
        },
        'onRevokeChoice': function() {
          gaOptoutRevoke()
        }
      })
    });
    </script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="./resources/prism/prism-1.20.0.css" type="text/css">
    <link rel="stylesheet" href="./css/ol.css" type="text/css">
    <link rel="stylesheet" href="./resources/layout.css" type="text/css">
    <script src="https://unpkg.com/elm-pep"></script>
    <script src="https://cdn.polyfill.io/v3/polyfill.min.js?features=fetch,requestAnimationFrame,Element.prototype.classList,URL,TextDecoder"></script>
    <script src="https://unpkg.com/dom-to-image-more@2.8.0/dist/dom-to-image-more.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
    <link rel="stylesheet" href="print-to-scale.css">
    <title>Print to scale example</title>
  </head>
  <body>

    <header class="navbar navbar-expand-sm navbar-dark mb-3 py-0" role="navigation">
      <a class="navbar-brand" href="https://openlayers.org/"><img src="./resources/logo-70x70.png" alt="">&nbsp;OpenLayers</a>

      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#olmenu" aria-controls="olmenu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- menu items that get hidden below 768px width -->
      <nav class="collapse navbar-collapse" id="olmenu">
        <ul class="nav navbar-nav ml-auto">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="docdropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Docs</a>
            <div class="dropdown-menu dropdown-menu-right mb-3" aria-labelledby="docdropdown">
              <a class="dropdown-item" href="../doc/">Docs</a>
              <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="../doc/quickstart.html"><i class="fa fa-check fa-fw mr-2 fa-lg"></i>Quick Start</a>
                <a class="dropdown-item" href="../doc/faq.html"><i class="fa fa-question fa-fw mr-2 fa-lg"></i>FAQ</a>
                <a class="dropdown-item" href="../doc/tutorials/"><i class="fa fa-book fa-fw mr-2 fa-lg"></i>Tutorials</a>
                <a class="dropdown-item" href="/workshop/"><i class="fa fa-graduation-cap fa-fw mr-2 fa-lg"></i>Workshop</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="https://stackoverflow.com/questions/tagged/openlayers"><i class="fa fa-stack-overflow fa-fw mr-2"></i>Ask a Question</a>
            </div>
          </li>
          <li class="nav-item active"><a class="nav-link" href="../examples/">Examples</a></li>
          <li class="nav-item"><a class="nav-link" href="../apidoc/"><i class="fa fa-sitemap mr-1"></i>API</a></li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="codedropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Code</a>
            <div class="dropdown-menu dropdown-menu-right mb-3" aria-labelledby="codedropdown">
              <a class="dropdown-item" href="https://github.com/openlayers/openlayers"><i class="fa fa-github fa-fw mr-2 fa-lg"></i>Repository</a>
              <a class="dropdown-item" href="/download/"><i class="fa fa-download fa-fw mr-2 fa-lg"></i>Download</a>
            </div>
           </li>
        </ul>
      </nav>
    </header>

    <div class="container-fluid line-numbers">

      <div id="latest-check" class="alert alert-warning alert-dismissible" role="alert" style="display:none">
        <button id="latest-dismiss" type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        This example uses OpenLayers v<span>6.5.0</span>. The <a id="latest-link" href="#" class="alert-link">latest</a> is v<span id="latest-version"></span>.
      </div>


      <div class="row-fluid">
        <a href="#" id="codepen-button" class="btn btn-link float-right">
          <i class="fa fa-codepen fa-lg"></i> Edit
        </a>
        <div class="span12">
          <h4 id="title">Print to scale example</h4>
          <p class="tags">
            <span class="badge-group">
              <a
                href="./index.html?q=print" class="badge badge-info">print</a
              ><a
                class="badge badge-info tag-modal-toggle text-white"
                data-toggle="modal"
                data-target="#tag-example-list"
                data-title="print"
                data-content="
                  &lt;a class=&quot;list-group-item list-group-item-action active&quot; href=&quot;./print-to-scale.html&quot;&gt;Print to scale example&lt;/a&gt;"
                tabindex="0"
                >1</a>
            </span>
            <span class="badge-group">
              <a
                href="./index.html?q=printing" class="badge badge-info">printing</a
              ><a
                class="badge badge-info tag-modal-toggle text-white"
                data-toggle="modal"
                data-target="#tag-example-list"
                data-title="printing"
                data-content="
                  &lt;a class=&quot;list-group-item list-group-item-action active&quot; href=&quot;./print-to-scale.html&quot;&gt;Print to scale example&lt;/a&gt;"
                tabindex="0"
                >1</a>
            </span>
            <span class="badge-group">
              <a
                href="./index.html?q=scale" class="badge badge-info">scale</a
              ><a
                class="badge badge-info tag-modal-toggle text-white"
                data-toggle="modal"
                data-target="#tag-example-list"
                data-title="scale"
                data-content="
                  &lt;a class=&quot;list-group-item list-group-item-action&quot; href=&quot;./icon-scale.html&quot;&gt;Icon Scale&lt;/a&gt;
                  &lt;a class=&quot;list-group-item list-group-item-action active&quot; href=&quot;./print-to-scale.html&quot;&gt;Print to scale example&lt;/a&gt;"
                tabindex="0"
                >2</a>
            </span>
            <span class="badge-group">
              <a
                href="./index.html?q=scaleline" class="badge badge-info">scaleline</a
              ><a
                class="badge badge-info tag-modal-toggle text-white"
                data-toggle="modal"
                data-target="#tag-example-list"
                data-title="scaleline"
                data-content="
                  &lt;a class=&quot;list-group-item list-group-item-action&quot; href=&quot;./scaleline-indiana-east.html&quot;&gt;OpenStreetMap Reprojection with ScaleLine Control&lt;/a&gt;
                  &lt;a class=&quot;list-group-item list-group-item-action active&quot; href=&quot;./print-to-scale.html&quot;&gt;Print to scale example&lt;/a&gt;"
                tabindex="0"
                >2</a>
            </span>
            <span class="badge-group">
              <a
                href="./index.html?q=export" class="badge badge-info">export</a
              ><a
                class="badge badge-info tag-modal-toggle text-white"
                data-toggle="modal"
                data-target="#tag-example-list"
                data-title="export"
                data-content="
                  &lt;a class=&quot;list-group-item list-group-item-action&quot; href=&quot;./export-pdf.html&quot;&gt;Export PDF example&lt;/a&gt;
                  &lt;a class=&quot;list-group-item list-group-item-action&quot; href=&quot;./export-map.html&quot;&gt;Map Export&lt;/a&gt;
                  &lt;a class=&quot;list-group-item list-group-item-action active&quot; href=&quot;./print-to-scale.html&quot;&gt;Print to scale example&lt;/a&gt;"
                tabindex="0"
                >3</a>
            </span>
            <span class="badge-group">
              <a
                href="./index.html?q=pdf" class="badge badge-info">pdf</a
              ><a
                class="badge badge-info tag-modal-toggle text-white"
                data-toggle="modal"
                data-target="#tag-example-list"
                data-title="pdf"
                data-content="
                  &lt;a class=&quot;list-group-item list-group-item-action&quot; href=&quot;./export-pdf.html&quot;&gt;Export PDF example&lt;/a&gt;
                  &lt;a class=&quot;list-group-item list-group-item-action active&quot; href=&quot;./print-to-scale.html&quot;&gt;Print to scale example&lt;/a&gt;"
                tabindex="0"
                >2</a>
            </span>
          </p>
          <div class="modal modal-tag-example" id="tag-example-list" tabindex="-1" role="dialog" aria-labelledby="tag-example-title" aria-hidden="true">
            <div class="modal-dialog modal-dialog-scrollable" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="tag-example-title"></h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <div class="list-group"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="wrapper">
  <div id="map" class="map"></div>
</div>
<form class="form">
  <label for="format">Page size </label>
  <select id="format">
    <option value="a0">A0 (slow)</option>
    <option value="a1">A1</option>
    <option value="a2">A2</option>
    <option value="a3">A3</option>
    <option value="a4" selected>A4</option>
    <option value="a5">A5 (fast)</option>
  </select>
  <label for="resolution">Resolution </label>
  <select id="resolution">
    <option value="72">72 dpi (fast)</option>
    <option value="150">150 dpi</option>
    <option value="200" selected>200 dpi</option>
    <option value="300">300 dpi (slow)</option>
  </select>
  <label for="scale">Scale </label>
  <select id="scale">
    <option value="500">1:500000</option>
    <option value="250" selected>1:250000</option>
    <option value="100">1:100000</option>
    <option value="50">1:50000</option>
    <option value="25">1:25000</option>
    <option value="10">1:10000</option>
  </select>
</form>
<button id="export-pdf">Export PDF</button>

        </div>
        <form method="POST" id="codepen-form" target="_blank" action="https://codesandbox.io/api/v1/sandboxes/define">
          <input id="codesandbox-params" type="hidden" name="parameters">
        </form>
      </div>

      <div class="row-fluid">
        <div class="span12">
          <p id="shortdesc">Example of printing a map to a specified scale.</p>
          <div id="docs"><p>Example of printing a map to a specified scale. The print is exported as a PDF using the <a href="https://github.com/MrRio/jsPDF" target="_blank">jsPDF</a> library. Unlike the <a href="export-pdf.html">Export PDF example</a> the on screen map is only used to set the center and rotation. The extent printed depends on the scale and page size. To print the scale bar and attributions the example uses the <a href="https://github.com/1904labs/dom-to-image-more" target="_blank">dom-to-image-more</a> library. Due to browser limitations and restrictions <b>Internet Explorer and Safari are not supported</b>.</p>
</div>
        </div>
      </div>

      <div class="row-fluid">
        <h5 class="source-heading">main.js</h5>
        <pre><code id="example-js-source" class="language-js">import 'ol/ol.css';
import Map from &#x27;ol/Map&#x27;;
import TileLayer from &#x27;ol/layer/Tile&#x27;;
import View from &#x27;ol/View&#x27;;
import WMTS, {optionsFromCapabilities} from &#x27;ol/source/WMTS&#x27;;
import WMTSCapabilities from &#x27;ol/format/WMTSCapabilities&#x27;;
import proj4 from &#x27;proj4&#x27;;
import {ScaleLine, defaults as defaultControls} from &#x27;ol/control&#x27;;
import {getPointResolution, get as getProjection} from &#x27;ol/proj&#x27;;
import {register} from &#x27;ol/proj/proj4&#x27;;

proj4.defs(
  &#x27;EPSG:27700&#x27;,
  &#x27;+proj&#x3D;tmerc +lat_0&#x3D;49 +lon_0&#x3D;-2 +k&#x3D;0.9996012717 &#x27; +
    &#x27;+x_0&#x3D;400000 +y_0&#x3D;-100000 +ellps&#x3D;airy &#x27; +
    &#x27;+towgs84&#x3D;446.448,-125.157,542.06,0.15,0.247,0.842,-20.489 &#x27; +
    &#x27;+units&#x3D;m +no_defs&#x27;
);

register(proj4);

var proj27700 &#x3D; getProjection(&#x27;EPSG:27700&#x27;);
proj27700.setExtent([0, 0, 700000, 1300000]);

var raster &#x3D; new TileLayer();

var url &#x3D;
  &#x27;https://tiles.arcgis.com/tiles/qHLhLQrcvEnxjtPr/arcgis/rest/services/OS_Open_Raster/MapServer/WMTS&#x27;;
fetch(url)
  .then(function (response) {
    return response.text();
  })
  .then(function (text) {
    var result &#x3D; new WMTSCapabilities().read(text);
    var options &#x3D; optionsFromCapabilities(result, {
      layer: &#x27;OS_Open_Raster&#x27;,
    });
    options.attributions &#x3D;
      &#x27;Contains OS data Â© Crown Copyright and database right &#x27; +
      new Date().getFullYear();
    options.crossOrigin &#x3D; &#x27;&#x27;;
    options.projection &#x3D; proj27700;
    options.wrapX &#x3D; false;
    raster.setSource(new WMTS(options));
  });

var map &#x3D; new Map({
  layers: [raster],
  controls: defaultControls({
    attributionOptions: {collapsible: false},
  }),
  target: &#x27;map&#x27;,
  view: new View({
    center: [373500, 436500],
    projection: proj27700,
    zoom: 7,
  }),
});

var scaleLine &#x3D; new ScaleLine({bar: true, text: true, minWidth: 125});
map.addControl(scaleLine);

var dims &#x3D; {
  a0: [1189, 841],
  a1: [841, 594],
  a2: [594, 420],
  a3: [420, 297],
  a4: [297, 210],
  a5: [210, 148],
};

// export options for html-to-image.
// See: https://github.com/bubkoo/html-to-image#options
var exportOptions &#x3D; {
  filter: function (element) {
    var className &#x3D; element.className || &#x27;&#x27;;
    return (
      className.indexOf(&#x27;ol-control&#x27;) &#x3D;&#x3D;&#x3D; -1 ||
      className.indexOf(&#x27;ol-scale&#x27;) &gt; -1 ||
      (className.indexOf(&#x27;ol-attribution&#x27;) &gt; -1 &amp;&amp;
        className.indexOf(&#x27;ol-uncollapsible&#x27;))
    );
  },
};

var exportButton &#x3D; document.getElementById(&#x27;export-pdf&#x27;);

exportButton.addEventListener(
  &#x27;click&#x27;,
  function () {
    exportButton.disabled &#x3D; true;
    document.body.style.cursor &#x3D; &#x27;progress&#x27;;

    var format &#x3D; document.getElementById(&#x27;format&#x27;).value;
    var resolution &#x3D; document.getElementById(&#x27;resolution&#x27;).value;
    var scale &#x3D; document.getElementById(&#x27;scale&#x27;).value;
    var dim &#x3D; dims[format];
    var width &#x3D; Math.round((dim[0] * resolution) / 25.4);
    var height &#x3D; Math.round((dim[1] * resolution) / 25.4);
    var viewResolution &#x3D; map.getView().getResolution();
    var scaleResolution &#x3D;
      scale /
      getPointResolution(
        map.getView().getProjection(),
        resolution / 25.4,
        map.getView().getCenter()
      );

    map.once(&#x27;rendercomplete&#x27;, function () {
      exportOptions.width &#x3D; width;
      exportOptions.height &#x3D; height;
      domtoimage
        .toJpeg(map.getViewport(), exportOptions)
        .then(function (dataUrl) {
          var pdf &#x3D; new jsPDF(&#x27;landscape&#x27;, undefined, format);
          pdf.addImage(dataUrl, &#x27;JPEG&#x27;, 0, 0, dim[0], dim[1]);
          pdf.save(&#x27;map.pdf&#x27;);
          // Reset original map size
          scaleLine.setDpi();
          map.getTargetElement().style.width &#x3D; &#x27;&#x27;;
          map.getTargetElement().style.height &#x3D; &#x27;&#x27;;
          map.updateSize();
          map.getView().setResolution(viewResolution);
          exportButton.disabled &#x3D; false;
          document.body.style.cursor &#x3D; &#x27;auto&#x27;;
        });
    });

    // Set print size
    scaleLine.setDpi(resolution);
    map.getTargetElement().style.width &#x3D; width + &#x27;px&#x27;;
    map.getTargetElement().style.height &#x3D; height + &#x27;px&#x27;;
    map.updateSize();
    map.getView().setResolution(scaleResolution);
  },
  false
);
</code></pre>
      </div>

      <div class="row-fluid">
        <h5 class="source-heading">index.html</h5>
        <pre><code id="example-html-source" class="language-markup">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
  &lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Print to scale example&lt;/title&gt;
    &lt;!-- Pointer events polyfill for old browsers, see https://caniuse.com/#feat=pointer --&gt;
    &lt;script src="https://unpkg.com/elm-pep"&gt;&lt;/script&gt;
    &lt;!-- The line below is only needed for old environments like Internet Explorer and Android 4.x --&gt;
    &lt;script src="https://cdn.polyfill.io/v3/polyfill.min.js?features=fetch,requestAnimationFrame,Element.prototype.classList,URL,TextDecoder"&gt;&lt;/script&gt;
    &lt;script src&#x3D;&quot;https://unpkg.com/dom-to-image-more@2.8.0/dist/dom-to-image-more.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src&#x3D;&quot;https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js&quot;&gt;&lt;/script&gt;
    &lt;style&gt;
      .map {
        width: 100%;
        height:400px;
      }
      .wrapper {
        max-width: 566px;
        width: 100%;
        height: 400px;
        overflow: hidden;
      }
    &lt;/style&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div class&#x3D;&quot;wrapper&quot;&gt;
      &lt;div id&#x3D;&quot;map&quot; class&#x3D;&quot;map&quot;&gt;&lt;/div&gt;
    &lt;/div&gt;
    &lt;form class&#x3D;&quot;form&quot;&gt;
      &lt;label for&#x3D;&quot;format&quot;&gt;Page size &lt;/label&gt;
      &lt;select id&#x3D;&quot;format&quot;&gt;
        &lt;option value&#x3D;&quot;a0&quot;&gt;A0 (slow)&lt;/option&gt;
        &lt;option value&#x3D;&quot;a1&quot;&gt;A1&lt;/option&gt;
        &lt;option value&#x3D;&quot;a2&quot;&gt;A2&lt;/option&gt;
        &lt;option value&#x3D;&quot;a3&quot;&gt;A3&lt;/option&gt;
        &lt;option value&#x3D;&quot;a4&quot; selected&gt;A4&lt;/option&gt;
        &lt;option value&#x3D;&quot;a5&quot;&gt;A5 (fast)&lt;/option&gt;
      &lt;/select&gt;
      &lt;label for&#x3D;&quot;resolution&quot;&gt;Resolution &lt;/label&gt;
      &lt;select id&#x3D;&quot;resolution&quot;&gt;
        &lt;option value&#x3D;&quot;72&quot;&gt;72 dpi (fast)&lt;/option&gt;
        &lt;option value&#x3D;&quot;150&quot;&gt;150 dpi&lt;/option&gt;
        &lt;option value&#x3D;&quot;200&quot; selected&gt;200 dpi&lt;/option&gt;
        &lt;option value&#x3D;&quot;300&quot;&gt;300 dpi (slow)&lt;/option&gt;
      &lt;/select&gt;
      &lt;label for&#x3D;&quot;scale&quot;&gt;Scale &lt;/label&gt;
      &lt;select id&#x3D;&quot;scale&quot;&gt;
        &lt;option value&#x3D;&quot;500&quot;&gt;1:500000&lt;/option&gt;
        &lt;option value&#x3D;&quot;250&quot; selected&gt;1:250000&lt;/option&gt;
        &lt;option value&#x3D;&quot;100&quot;&gt;1:100000&lt;/option&gt;
        &lt;option value&#x3D;&quot;50&quot;&gt;1:50000&lt;/option&gt;
        &lt;option value&#x3D;&quot;25&quot;&gt;1:25000&lt;/option&gt;
        &lt;option value&#x3D;&quot;10&quot;&gt;1:10000&lt;/option&gt;
      &lt;/select&gt;
    &lt;/form&gt;
    &lt;button id&#x3D;&quot;export-pdf&quot;&gt;Export PDF&lt;/button&gt;
    &lt;script src="main.js"&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
      </div>


      <div class="row-fluid">
        <h5 class="source-heading">package.json</h5>
        <pre><code id="example-pkg-source" class="language-json">{
  &quot;name&quot;: &quot;print-to-scale&quot;,
  &quot;dependencies&quot;: {
    &quot;ol&quot;: &quot;6.5.0&quot;,
    &quot;proj4&quot;: &quot;2.6.3&quot;
  },
  &quot;devDependencies&quot;: {
    &quot;parcel&quot;: &quot;^2.0.0-beta.1&quot;
  },
  &quot;scripts&quot;: {
    &quot;start&quot;: &quot;parcel index.html&quot;,
    &quot;build&quot;: &quot;parcel build --public-url . index.html&quot;
  }
}</code></pre>
      </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.bundle.min.js"></script>
    <script src="./resources/prism/prism-1.20.0.min.js"></script>
    <script src="./resources/common.js"></script>
    <script src="common.js"></script>
        <script src="print-to-scale.js"></script>
    <script>
      $('#tag-example-list').on('show.bs.modal', function (event) {
        const button = $(event.relatedTarget); // Button that triggered the modal
        const title = button.data('title');
        const content = button.data('content');
        const modal = $(this)
        modal.find('.modal-title').text(title);
        modal.find('.modal-body').html(content);
      });

      var packageUrl = 'https://raw.githubusercontent.com/openlayers/openlayers.github.io/build/package.json';
      fetch(packageUrl).then(function(response) {
        return response.json();
      }).then(function(json) {
        var latestVersion = json.version;
        document.getElementById('latest-version').innerHTML = latestVersion;
        var url = window.location.href;
        var branchSearch = url.match(/\/([^\/]*)\/examples\//);
        var cookieText = 'dismissed=-' + latestVersion + '-';
        var dismissed = document.cookie.indexOf(cookieText) != -1;
        if (branchSearch && !dismissed && /^v[0-9\.]*$/.test(branchSearch[1]) && '6.5.0' != latestVersion) {
          var link = url.replace(branchSearch[0], '/latest/examples/');
          fetch(link, {method: 'head'}).then(function(response) {
            var a = document.getElementById('latest-link');
            a.href = response.status == 200 ? link : '../../latest/examples/';
          });
          var latestCheck = document.getElementById('latest-check');
          latestCheck.style.display = '';
          document.getElementById('latest-dismiss').onclick = function() {
            latestCheck.style.display = 'none';
            document.cookie = cookieText;
          }
        }
      });
    </script>
  </body>
</html>
